
<!DOCTYPE html>
<html lang="zh-CN">
<head>
 <meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<meta HTTP-EQUIV="pragma" CONTENT="no-cache">
<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<meta HTTP-EQUIV="expires" CONTENT="0">
<meta name="author" content="bwrong, wang11535041@qq.com"/>
<meta name="keywords" content="ã€Vue3ã€‘åŸºç¡€ä¸å…¥é—¨ | BWrongçš„å°ç«™,å‰ç«¯,krpano,js,vue"/>
<meta name="description" content="å¤©é’è‰²ç­‰çƒŸé›¨ï¼Œè€Œæˆ‘åœ¨ç­‰ä½ "/>
<!-- <title>ã€Vue3ã€‘åŸºç¡€ä¸å…¥é—¨ | BWrongçš„å°ç«™</title> -->
<title>ç½‘ç«™æ­å»ºæµ‹è¯•</title>
<link href="https://www.bwrong.cn/media/css/fz.css" rel="stylesheet">
<link rel="stylesheet" href="https://www.bwrong.cn/styles/main.css">
<script type="text/javascript">
function getCSS()
{
        datetoday = new Date();
        timenow=datetoday.getTime();
        datetoday.setTime(timenow);
        thehour = datetoday.getHours();

        if (thehour<5)

            display = "https://www.bwrong.cn/media/css/night.css";

       else if (thehour>20)

            display = "https://www.bwrong.cn/media/css/night.css";

        else if (thehour>5)
     
            display = "https://www.bwrong.cn/media/css/day.css";

        else if (thehour<20)

            display = "https://www.bwrong.cn/media/css/day.css";


var css = '<';
        css+='link rel="stylesheet" href='+display+' \/';
        css+='>';
        document.write(css);
}
</script>
<link href="https://at.alicdn.com/t/font_1306644_ko4c4at97is.css" rel="stylesheet" />
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://www.bwrong.cn/media/css/katex.min.css">
<script type='text/javascript' src='https://www.bwrong.cn/media/scripts/script.js'></script>
<link href="https://cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet" />
  <script src="https://cdn.bootcss.com/wow/1.1.2/wow.min.js"></script>
  <script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>wow=new WOW({boxClass:'wow',animateClass:'animated',offset:0,mobile:true,live:true});wow.init();</script>

<script type="text/javascript">
window.onload=getCSS();
</script>
<!-- ç™¾åº¦ç»Ÿè®¡ -->
<script>
var _hmt = _hmt || [];
(function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?2c0e9e3f54ae20480b34c178578c4df8";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="post-template-default single single-post postid-70 single-format-standard">
    <div id="wrapper">

	
<header id="header" class="site-header"
		
		style="background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(https://www.bwrong.cn/post-images/vue3-01.jpg)"
		
		>
			<div class="site-branding">
									<h1 class="site-title"><a href="https://www.bwrong.cn" rel="home">BWrongçš„å°ç«™</a></h1>

					<h2 class="site-description">å¤©é’è‰²ç­‰çƒŸé›¨ï¼Œè€Œæˆ‘åœ¨ç­‰ä½ </h2>

							</div>
			<nav id="nav-wrapper">
				<div class="container">
					<div class="nav-toggle">
						<div class="bars">
							<div class="bar"></div>
							<div class="bar"></div>
							<div class="bar"></div>
						</div>
					</div>
					<div class="clear"></div>
					<ul id="" class="dove">
		 

<li>

	
		<a href="/">
		  é¦–é¡µ
		</a>
	  

    

<li>

	
		<a href="/archives/index.html">
		  å½’æ¡£
		</a>
	  

    

<li>

	
		<a href="/post/about/">
		  å…³äº
		</a>
	  

    

</ul>
</li>

</ul>				</div>
			</nav>
						<div class="jingge">


    

    

<a  href="https://github.com/BWrong" target="_blank" ><i class="iconfont icon-github"></i></a>
 
    

    

    

    

<a  href="https://juejin.cn/user/3421335914820280" target="_blank" ><i class="iconfont icon-telegram"></i></a>
 
    

    

    

    

    

    
        </header>


		<div id="content" class="container">
			<div class="row">
	<div class="col-md-8 site-main">

<article id="post-70" class="post-70 post type-post status-publish format-standard hentry category-5 tag-10 tag-9 tag-11">



		<div class="entry-content">
			<h1 data-wow-delay="0.4s"  class="wow fadeInUp entry-title">ã€Vue3ã€‘åŸºç¡€ä¸å…¥é—¨</h1>
<div class="entry-meta">
<div class="wow fadeInUp"  data-wow-delay="0.6s">
	<i class="iconfont icon-rili"> <time class="lately-a" datetime="2021-09-02 15:31:46" itemprop="datePublished" pubdate="">2021-09-02</time></i>
	          </div>

</span>

		</div>

			<div class="wow fadeInUp entry-summary song"  data-wow-delay="0.1s">
				<p>å­—æ•°ï¼š7887ï¼Œ é˜…è¯»æ—¶é—´ï¼š40åˆ†é’Ÿï¼Œç‚¹å‡»<a href="https://www.bwrong.cn/post/vue3-01/">é˜…è¯»åŸæ–‡</a></p>
<figure data-type="image" tabindex="1"><img src="https://www.bwrong.cn/post-images/javascript-module.jpg" alt="" loading="lazy"></figure>
<p>ä»2013å¹´12æœˆ8æ—¥å‘å¸ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬è‡³ä»Šå·²ï¼ŒVueå·²èµ°è¿‡äº†å¿«å…«ä¸ªå¹´å¤´ï¼Œä½ äº†è§£æ¯ä¸ªç‰ˆæœ¬åå­—çš„æ„ä¹‰å—ï¼Ÿ</p>
<table>
<thead>
<tr>
<th>ç‰ˆæœ¬å·</th>
<th>åå­—</th>
<th>é‡Šä¹‰</th>
<th>æ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>V0.9</td>
<td>Animatrix</td>
<td>é»‘å®¢å¸å›½åŠ¨ç”»ç‰ˆ</td>
<td>2014.2.25</td>
</tr>
<tr>
<td>V0.10</td>
<td>Blade Runner</td>
<td>é“¶ç¿¼æ€æ‰‹</td>
<td>2014.3.23</td>
</tr>
<tr>
<td>V0.11</td>
<td>Cowboy Bebop</td>
<td>æ˜Ÿé™…ç‰›ä»”</td>
<td>2014.11.7</td>
</tr>
<tr>
<td>V0.12</td>
<td>Dragon Ball</td>
<td>é¾™ç </td>
<td>2015.6.12</td>
</tr>
<tr>
<td>V1.0</td>
<td>Evangelion</td>
<td>æ–°ä¸–çºªç¦éŸ³æˆ˜å£«</td>
<td>2015.10.27</td>
</tr>
<tr>
<td>V2.0</td>
<td>Ghost in the Shell</td>
<td>æ”»å£³æœºåŠ¨é˜Ÿ</td>
<td>2016.9.30</td>
</tr>
<tr>
<td>V2.1</td>
<td>Hunter X Hunter</td>
<td>å…¨èŒçŒäºº</td>
<td>2016.11.22</td>
</tr>
<tr>
<td>V2.2</td>
<td>Initial D</td>
<td>å¤´æ–‡å­—D</td>
<td>2017.2.26</td>
</tr>
<tr>
<td>V2.3</td>
<td>JoJo's Bizarre Adventure</td>
<td>JoJoçš„å¥‡å¦™å†’é™©</td>
<td>2017.4.2</td>
</tr>
<tr>
<td>V2.4</td>
<td>Kill la Kill</td>
<td>æ–©æœå°‘å¥³</td>
<td>2017.7.13</td>
</tr>
<tr>
<td><strong>V2.5</strong></td>
<td>Level E</td>
<td>çµå¼‚Eæ¥è§¦</td>
<td>2017.10.13</td>
</tr>
<tr>
<td><strong>V2.6</strong></td>
<td>Macross</td>
<td>è¶…æ—¶ç©ºè¦å¡</td>
<td>2019.2.4</td>
</tr>
<tr>
<td>V3.0</td>
<td>One Piece</td>
<td>æµ·è´¼ç‹</td>
<td>2020.9.18</td>
</tr>
<tr>
<td>V3.1</td>
<td>Pluto</td>
<td>åœ°ä¸Šæœ€å¼ºæœºå™¨äºº</td>
<td>2021.6.8</td>
</tr>
<tr>
<td>V3.2</td>
<td>Quintessential Quintuplets</td>
<td>äº”ç­‰åˆ†çš„èŠ±å«</td>
<td>2021.8.10</td>
</tr>
</tbody>
</table>
<p>åŸæ¥æ¯ä¸ªç‰ˆæœ¬çš„åå­—éƒ½æ˜¯ä»¥æ¼«ç”»å‘½åï¼Œé‚£ä¹ˆè¿™äº›åŠ¨æ¼«ï¼Œä½ çœ‹è¿‡å‡ éƒ¨å‘¢ï¼Ÿ</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±é‡ç‚¹èŠèŠVue3.0ã€‚</p>
<h1 id="ç¼˜èµ·">ç¼˜èµ·</h1>
<p>ä¸€ä¸ªæ–°å·¥å…·çš„å‡ºç°ï¼Œä¸€å®šæ˜¯ä¸ºäº†è§£å†³å·²æœ‰å·¥å…·å­˜åœ¨çš„é—®é¢˜ã€‚æˆ‘ä»¬å¸¸å¸¸å¬è¯´Vueä¸é€‚åˆå¼€å‘å¤§å‹å¤æ‚çš„é¡¹ç›®ï¼Œä¸€ä¸ªæ ¹æœ¬åŸå› æ˜¯ Vue ç°æœ‰çš„ API è¿«ä½¿æˆ‘ä»¬é€šè¿‡é€‰é¡¹ç»„ç»‡ä»£ç ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™é€šè¿‡é€»è¾‘å…³ç³»ç»„ç»‡ä»£ç æ›´æœ‰æ„ä¹‰ã€‚å¦ä¸€ä¸ªåŸå› æ˜¯ç›®å‰ç¼ºå°‘ä¸€ç§ç®€æ´ä¸”ä½æˆæœ¬çš„æœºåˆ¶æ¥æå–å’Œé‡ç”¨å¤šä¸ªç»„ä»¶ä¹‹é—´çš„é€»è¾‘ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹2.0çš„é—®é¢˜ï¼Œä»¥åŠVue3æ˜¯å¦‚ä½•æ¥è§£å†³çš„ã€‚</p>
<h2 id="optionå¼ç»„ç»‡ä»£ç çš„ç¼ºé™·">Optionå¼ç»„ç»‡ä»£ç çš„ç¼ºé™·</h2>
<p>optionså¼ç»„ç»‡ä»£ç ï¼ŒåŒä¸€ä¸ªåŠŸèƒ½åˆ†æ•£åœ¨å„ä¸ªoptionä¸­ï¼Œå¯¼è‡´åœ¨å¼€å‘æ—¶éœ€è¦åœ¨dataã€methodsã€computedç­‰optionæ¨ªè·³ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://gitee.com/letwrong/Picture/raw/master/20210821095807.awebp" alt="option" loading="lazy"></figure>
<p>Vue3æ¨å‡ºäº†CompositionApiï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå°†åˆ†æ•£åœ¨å„ä¸ªoptionä¸­çš„é€»è¾‘ç»„åˆåˆ°ä¸€èµ·ï¼Œä¸‹é¢æˆ‘ä»¬å¯¹æ¯”çœ‹ä¸‹ï¼š</p>
<figure data-type="image" tabindex="3"><img src="https://gitee.com/letwrong/Picture/raw/master/20210821095754.awebp" alt="" loading="lazy"></figure>
<h2 id="mixinçš„é—®é¢˜">Mixinçš„é—®é¢˜</h2>
<p>å¯¹äºå¤æ‚çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨Mixinæ¥æŠ½ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ã€‚ä½†æ˜¯Mixinä¼šæœ‰ä¸€äº›ä½¿ç”¨ä¸Šçš„é—®é¢˜ï¼Œæ¯”å¦‚å‘½åå†²çªã€å±æ€§æ¥æºä¸æ˜ç¡®ã€‚</p>
<p>Vue3æå‡ºäº†Hooksçš„æ–¹å¼ï¼Œå¯ä»¥å°†æ¯ä¸ªåŠŸèƒ½æå–åˆ°hooksï¼Œä¸€ä¸ªhookså³æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸ä¼šå†æœ‰ä¸Šè¿°é—®é¢˜ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://gitee.com/letwrong/Picture/raw/master/20210821095749.awebp" alt="" loading="lazy"></figure>
<h2 id="typescriptæ”¯æŒçš„ä¸å¥å…¨">TypeScriptæ”¯æŒçš„ä¸å¥å…¨</h2>
<p>ç°åœ¨å¤§å‹é¡¹ç›®éƒ½ä¼šæ ‡é… TypeScript ï¼ŒVue å½“å‰çš„ API åœ¨é›†æˆ TypeScript æ—¶é‡åˆ°äº†ä¸å°çš„éº»çƒ¦ï¼Œå…¶ä¸»è¦åŸå› æ˜¯ Vue ä¾é ä¸€ä¸ªç®€å•çš„ <code>this</code> ä¸Šä¸‹æ–‡æ¥æš´éœ² propertyï¼Œæˆ‘ä»¬ç°åœ¨ä½¿ç”¨ <code>this</code> çš„æ–¹å¼æ˜¯æ¯”è¾ƒå¾®å¦™çš„ã€‚ï¼ˆæ¯”å¦‚ <code>methods</code> é€‰é¡¹ä¸‹çš„å‡½æ•°çš„ <code>this</code> æ˜¯æŒ‡å‘ç»„ä»¶å®ä¾‹çš„ï¼Œè€Œä¸æ˜¯è¿™ä¸ª <code>methods</code> å¯¹è±¡ï¼‰ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼ŒVue ç°æœ‰çš„ API åœ¨è®¾è®¡ä¹‹åˆæ²¡æœ‰ç…§é¡¾åˆ°ç±»å‹æ¨å¯¼ï¼Œè¿™ä½¿é€‚é… TypeScript å˜å¾—å¤æ‚ã€‚</p>
<p>å½“å‰ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨ TypeScript çš„ Vue å¼€å‘è€…éƒ½åœ¨é€šè¿‡ <code>vue-class-component</code> è¿™ä¸ªåº“å°†ç»„ä»¶æ’°å†™ä¸º TypeScript class (å€ŸåŠ© decorator)ã€‚å®ƒå¿…é¡»ä¾èµ– decoratorâ€”â€”ä¸€ä¸ªåœ¨å®ç°ç»†èŠ‚ä¸Šå­˜åœ¨è®¸å¤šæœªçŸ¥æ•°çš„éå¸¸ä¸ç¨³å®šçš„ stage 2 ææ¡ˆã€‚åŸºäºå®ƒæ˜¯æœ‰æå¤§é£é™©çš„ã€‚</p>
<p>Vue3ä¸­æå‡ºçš„æ–¹æ¡ˆæ›´å¤šåœ°åˆ©ç”¨äº†å¤©ç„¶å¯¹ç±»å‹å‹å¥½çš„æ™®é€šå˜é‡ä¸å‡½æ•°ï¼Œå®Œç¾äº«ç”¨ç±»å‹æ¨å¯¼ï¼Œå¹¶ä¸”ä¹Ÿä¸ç”¨åšå¤ªå¤šé¢å¤–çš„ç±»å‹æ ‡æ³¨ã€‚</p>
<p>è¿™ä¹ŸåŒæ ·æ„å‘³ç€ä½ å†™å‡ºçš„ JavaScript ä»£ç å‡ ä¹å°±æ˜¯ TypeScript çš„ä»£ç ã€‚å³ä½¿æ˜¯é TypeScript å¼€å‘è€…ä¹Ÿä¼šå› æ­¤å¾—åˆ°æ›´å¥½çš„ IDE ç±»å‹æ”¯æŒè€Œè·ç›Šã€‚</p>
<h2 id="æ›´å¥½çš„å“åº”å¼å’Œæ€§èƒ½">æ›´å¥½çš„å“åº”å¼å’Œæ€§èƒ½</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒVue2çš„å“åº”å¼æ˜¯é€šè¿‡<code>Object.defineProperty</code> æ˜¯ç»™å¯¹è±¡çš„æŸä¸ªå·²å­˜åœ¨çš„å±æ€§æ·»åŠ å¯¹åº”çš„ <code>getter</code> å’Œ <code>setter</code>ï¼Œæ‰€ä»¥å®ƒåªèƒ½ç›‘å¬è¿™ä¸ªå±æ€§å€¼çš„å˜åŒ–ï¼Œè€Œä¸èƒ½å»ç›‘å¬å¯¹è±¡å±æ€§çš„æ–°å¢å’Œåˆ é™¤ã€‚åœ¨ Vue 2 çš„å®ç°ä¸­ï¼Œåœ¨ç»„ä»¶åˆå§‹åŒ–é˜¶æ®µæŠŠæ•°æ®å˜æˆå“åº”å¼æ—¶ï¼Œé‡åˆ°å­å±æ€§ä»ç„¶æ˜¯å¯¹è±¡çš„æƒ…å†µï¼Œä¼šé€’å½’æ‰§è¡Œ <code>Object.defineProperty</code> å®šä¹‰å­å¯¹è±¡çš„å“åº”å¼ï¼Œä¼šæœ‰ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚è€Œä¸”è¿˜æœ‰ä¸€ä¸ªå¸¸è§çš„é—®é¢˜å°±æ˜¯é€šè¿‡ç´¢å¼•ä¿®æ”¹æ•°ç»„ã€ä¸ºå¯¹è±¡ç›´æ¥æ–°å¢å±æ€§ï¼Œå¹¶ä¸ä¼šè§¦å‘å“åº”å¼æ›´æ–°æœºåˆ¶ã€‚</p>
<p>è€Œåœ¨Vue3ä¸­åˆ™ä½¿ç”¨äº†Proxyæ¥å®ç°å“åº”å¼ï¼Œå…¶å®å¹¶ä¸æ˜¯Proxyçš„æœ¬èº«çš„æ€§èƒ½ä¼˜äº<code>Object.defineProperty</code>ï¼Œå…¶å®æ°æ°ç›¸åã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦é€‰æ‹©Proxyå‘¢ï¼Ÿ</p>
<p>å› ä¸º <code>Proxy</code> æœ¬è´¨ä¸Šæ˜¯å¯¹æŸä¸ªå¯¹è±¡çš„åŠ«æŒï¼Œè¿™æ ·å®ƒä¸ä»…ä»…å¯ä»¥ç›‘å¬å¯¹è±¡æŸä¸ªå±æ€§å€¼çš„å˜åŒ–ï¼Œè¿˜å¯ä»¥ç›‘å¬å¯¹è±¡å±æ€§çš„æ–°å¢å’Œåˆ é™¤ã€‚è€Œä¸”åœ¨å®ç°å“åº”å¼æ—¶ï¼Œé‡‡ç”¨äº†å»¶æ—¶å¤„ç†çš„æ–¹å¼ï¼Œå½“åµŒå¥—è¾ƒæ·±çš„å¯¹è±¡æ—¶ï¼Œåªæœ‰åœ¨å…¶å±æ€§è¢«è®¿é—®çš„æ—¶å€™æ‰ä¼šå¤„ç†å±æ€§çš„å“åº”å¼ï¼Œåœ¨æ€§èƒ½ä¸Šä¼šæœ‰ä¸€å®šçš„æå‡ã€‚</p>
<h2 id="æ”¯æŒå…¨å±€api-treeshaking">æ”¯æŒå…¨å±€API Treeshaking</h2>
<p>Vue3é‡æ„äº†å…¨å±€å’Œå±€éƒ¨çš„apiï¼Œå‡é‡‡ç”¨ESModuleçš„å‘½åå¯¼å‡ºè®¿é—®ï¼Œæ”¯æŒtree-shakingï¼Œåªæ‰“åŒ…ä½¿ç”¨åˆ°çš„åŠŸèƒ½ï¼Œç”¨æˆ·åªä¸ºå®é™…ä½¿ç”¨çš„åŠŸèƒ½ä¹°å•ï¼ŒåŒæ—¶åŒ…ä½“ç§¯çš„å‡å°‘ï¼Œä¹Ÿæ„å‘³ç€æ€§èƒ½çš„æå‡ã€‚</p>
<pre><code class="language-js">// vue2
import Vue from 'vue'

Vue.nextTick(() =&gt; {
  // ä¸€äº›å’ŒDOMæœ‰å…³çš„ä¸œè¥¿
})

</code></pre>
<pre><code class="language-js">// vue3
import { nextTick } from 'vue'

nextTick(() =&gt; {
  // ä¸€äº›å’ŒDOMæœ‰å…³çš„ä¸œè¥¿
})
</code></pre>
<p>ä»¥ä¸Šå°±æ˜¯Vueä¸»è¦çš„å˜åŒ–ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹æœ‰å“ªäº›æ–°ç‰¹æ€§ã€‚</p>
<h1 id="æ–°ç‰¹æ€§ä¸å˜æ›´">æ–°ç‰¹æ€§ä¸å˜æ›´</h1>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ä¸€äº›éå…¼å®¹çš„é‡å¤§å˜æ›´ï¼š</p>
<h2 id="å…¨å±€api">å…¨å±€API</h2>
<ul>
<li>
<p>æ”¯æŒå¤šä¸ªåº”ç”¨æ ¹å®ä¾‹ï¼Œé˜²æ­¢å…¨å±€é…ç½®æ±¡æŸ“</p>
<pre><code class="language-js">// vue2
// è¿™ä¼šå½±å“ä¸¤ä¸ªæ ¹å®ä¾‹
Vue.mixin({
  /* ... */
})
const app1 = new Vue({ el: '#app-1' })
const app2 = new Vue({ el: '#app-2' })
</code></pre>
<pre><code class="language-js">// vue3
import { createApp } from 'vue'

const app = createApp({})
app.mixin({
  /* ... */
})
</code></pre>
<p>ä¸€äº›å…¶ä»–å…¨å±€Apiçš„å˜æ›´è¯¦æƒ…è¯·æŸ¥é˜…<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%85%A8%E5%B1%80-api-createapp">å…¨å±€ API</a>ã€‚</p>
</li>
<li>
<p>å…¨å±€ APIé‡æ„ä¸ºå¯Treeshaking</p>
<pre><code class="language-js">import { nextTick } from 'vue'

nextTick(() =&gt; {
  // ä¸€äº›å’ŒDOMæœ‰å…³çš„ä¸œè¥¿
})
// **** å—å½±å“çš„API
// Vue.nextTick
// Vue.observable (ç”¨ Vue.reactive æ›¿æ¢)
// Vue.version
// Vue.compile (ä»…å®Œæ•´æ„å»ºç‰ˆæœ¬)
// Vue.set (ä»…å…¼å®¹æ„å»ºç‰ˆæœ¬)
// Vue.delete (ä»…å…¼å®¹æ„å»ºç‰ˆæœ¬)
</code></pre>
</li>
</ul>
<h2 id="æ¨¡æ¿å’ŒæŒ‡ä»¤ç›¸å…³">æ¨¡æ¿å’ŒæŒ‡ä»¤ç›¸å…³</h2>
<ul>
<li>æ›´å¥½ç”¨çš„<code>v-model</code></li>
</ul>
<p>æ›¿ä»£åŸæœ‰çš„<code>v-model</code>å’Œ<code>v-bind.sync</code>ä¿®é¥°ç¬¦ï¼Œé€šè¿‡å‚æ•°å½¢å¼ï¼Œæ”¯æŒä½¿ç”¨å¤šä¸ª<code>v-model</code>è¿›è¡ŒåŒå‘ç»‘å®šã€‚</p>
<pre><code class="language-html">&lt;!-- vue2 --&gt;
&lt;ChildComponent v-model=&quot;pageTitle&quot; :title.sync=&quot;title&quot;/&gt;
&lt;!-- å®Œæ•´ --&gt;
&lt;ChildComponent :value=&quot;pageTitle&quot; @input=&quot;(title)=&gt; (pageTitle=title)&quot; :title=&quot;title&quot; @update:title=&quot;(title)=&gt; (title=title)&quot;/&gt;
</code></pre>
<pre><code class="language-html">&lt;!-- vue3 --&gt;
&lt;ChildComponent v-model=&quot;pageTitle&quot; v-modle:title=&quot;title&quot;/&gt;
&lt;!-- å®Œæ•´ --&gt;
&lt;ChildComponent :model-value=&quot;pageTitle&quot; @update:modelValue=&quot;(title)=&gt; (pageTitle=title)&quot; :title=&quot;title&quot; @update:title=&quot;(title)=&gt; (title=title)&quot;/&gt;
</code></pre>
<ul>
<li><code>&lt;template v-for&gt;</code>çš„å˜åŒ–</li>
</ul>
<pre><code class="language-vue">&lt;!-- vue2 --&gt;
&lt;template v-for=&quot;item in list&quot;&gt;
  &lt;div :key=&quot;'heading-' + item.id&quot;&gt;...&lt;/div&gt;
  &lt;span :key=&quot;'content-' + item.id&quot;&gt;...&lt;/span&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="language-vue">&lt;!-- vue 3 --&gt;
&lt;template v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;
  &lt;div&gt;...&lt;/div&gt;
  &lt;span&gt;...&lt;/span&gt;
&lt;/template&gt;
</code></pre>
<ul>
<li><code>v-bind</code> åˆå¹¶é¡ºåºå˜åŒ–</li>
</ul>
<pre><code class="language-html">&lt;!-- vue2 --&gt;
&lt;div id=&quot;red&quot; v-bind=&quot;{ id: 'blue' }&quot;&gt;&lt;/div&gt;
&lt;!-- result --&gt;
&lt;div id=&quot;red&quot;&gt;&lt;/div&gt;
</code></pre>
<pre><code class="language-html">&lt;!-- vue3 --&gt;
&lt;div id=&quot;red&quot; v-bind=&quot;{ id: 'blue' }&quot;&gt;&lt;/div&gt;
&lt;!-- result --&gt;
&lt;div id=&quot;blue&quot;&gt;&lt;/div&gt;
</code></pre>
<ul>
<li>
<p>ç§»é™¤<code>v-on.native</code>ä¿®é¥°ç¬¦</p>
<p>åœ¨ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¦å°†åŸç”Ÿ DOM ç›‘å¬å™¨æ·»åŠ åˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>.native</code> ä¿®é¥°ç¬¦ã€‚</p>
</li>
</ul>
<pre><code class="language-html">&lt;!-- vue2 --&gt;
&lt;my-component
  v-on:close=&quot;handleComponentEvent&quot;
  v-on:click.native=&quot;handleNativeClickEvent&quot;
/&gt;
</code></pre>
<p>åœ¨vue3ä¸­ï¼Œç»„ä»¶ä¸­<em>æœª</em>è¢«å®šä¹‰ä¸ºç»„ä»¶è§¦å‘çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨ï¼ŒVue ç°åœ¨å°†æŠŠå®ƒä»¬ä½œä¸ºåŸç”Ÿäº‹ä»¶ç›‘å¬å™¨æ·»åŠ åˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸­ (é™¤éåœ¨å­ç»„ä»¶çš„é€‰é¡¹ä¸­è®¾ç½®äº† <code>inheritAttrs: false</code>)</p>
<pre><code class="language-html">&lt;!-- vue3 --&gt;
&lt;my-component
  v-on:close=&quot;handleComponentEvent&quot;
  v-on:click=&quot;handleNativeClickEvent&quot;
/&gt;
&lt;script&gt;
  export default {
    emits: ['close']
  }
&lt;/script&gt;
</code></pre>
<ul>
<li>æ”¯æŒç‰‡æ®µï¼ˆå¤šæ ¹èŠ‚ç‚¹ï¼‰</li>
</ul>
<pre><code class="language-vue">&lt;!-- vue2 --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;header&gt;...&lt;/header&gt;
    &lt;main&gt;...&lt;/main&gt;
    &lt;footer&gt;...&lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>åœ¨vue2ä¸­ï¼Œç»„ä»¶å¿…é¡»åŒ…å«åœ¨æŸä¸ªå…ƒç´ å†…éƒ¨ï¼Œä¸æ”¯æŒå¤šä¸ªæ ¹èŠ‚ç‚¹ï¼Œè¿™æœ‰æ—¶ä¼šç»™æˆ‘ä»¬å†™æ ·å¼å¸¦æ¥çƒ¦æ¼ï¼Œæ‰€ä»¥vue3ä¸­æ”¯æŒäº†å¤šæ ¹èŠ‚ç‚¹ã€‚</p>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;header&gt;...&lt;/header&gt;
  &lt;main v-bind=&quot;$attrs&quot;&gt;...&lt;/main&gt;
  &lt;footer&gt;...&lt;/footer&gt;
&lt;/template&gt;
</code></pre>
<ul>
<li>æ–°å¢Teleportä¼ é€é—¨</li>
</ul>
<p>vueåº”ç”¨å¼€å‘çš„æ ¸å¿ƒå°±æ˜¯ç»„ä»¶ç¼–å†™ï¼Œå°† UI å’Œç›¸å…³è¡Œä¸ºå°è£…åˆ°ç»„ä»¶ä¸­æ¥æ„å»º UIã€‚ä½†æ˜¯æœ‰æ—¶ç»„ä»¶æ¨¡æ¿çš„ä¸€éƒ¨åˆ†é€»è¾‘ä¸Šå±äºè¯¥ç»„ä»¶ï¼Œè€Œä»æŠ€æœ¯è§’åº¦æ¥çœ‹ï¼Œæœ€å¥½å°†æ¨¡æ¿çš„è¿™ä¸€éƒ¨åˆ†ç§»åŠ¨åˆ° DOM ä¸­ Vue app ä¹‹å¤–çš„å…¶ä»–ä½ç½®ã€‚</p>
<p>æ¯”å¦‚æœ€å¸¸è§çš„æ¨¡æ€çª—ï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡æ€çª—çš„é€»è¾‘å­˜åœ¨äºç»„ä»¶ä¸­ï¼Œä½†åœ¨UIä¸Šï¼Œå…ƒç´ æœ€å¥½åˆæŒ‚è½½åˆ°DOMæ ¹èŠ‚ç‚¹ï¼ˆå¦‚bodyï¼‰ä¸Šï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œcssæ¥å®šä½ã€‚</p>
<pre><code class="language-html">&lt;body&gt;
  &lt;div style=&quot;position: relative;&quot;&gt;
    &lt;h3&gt;Tooltips with Vue 3 Teleport&lt;/h3&gt;
    &lt;div&gt;
      &lt;modal-button&gt;&lt;/modal-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
</code></pre>
<pre><code class="language-js">const app = Vue.createApp({});

app.component('modal-button', {
  template: `
    &lt;button @click=&quot;modalOpen = true&quot;&gt;
        Open full screen modal!
    &lt;/button&gt;

    &lt;div v-if=&quot;modalOpen&quot; class=&quot;modal&quot;&gt;
      &lt;div&gt;
        I'm a modal!
        &lt;button @click=&quot;modalOpen = false&quot;&gt;
          Close
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  `,
  data() {
    return {
      modalOpen: false
    }
  }
})
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªé—®é¢˜â€”â€”æ¨¡æ€æ¡†æ˜¯åœ¨æ·±åº¦åµŒå¥—çš„ <code>div</code> ä¸­æ¸²æŸ“çš„ï¼Œè€Œæ¨¡æ€æ¡†çš„ <code>position:absolute</code> ä»¥çˆ¶çº§ç›¸å¯¹å®šä½çš„ <code>div</code> ä½œä¸ºå¼•ç”¨ï¼Œæœ€ç»ˆçš„æ•ˆæœä¼šå—çˆ¶çº§å®šä½çš„å½±å“ï¼Œè¿™å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ç»“æœã€‚</p>
<p>Teleport æä¾›äº†ä¸€ç§å¹²å‡€çš„æ–¹æ³•ï¼Œå…è®¸æˆ‘ä»¬æ§åˆ¶åœ¨ DOM ä¸­å“ªä¸ªçˆ¶èŠ‚ç‚¹ä¸‹æ¸²æŸ“äº† HTMLï¼Œè€Œä¸å¿…æ±‚åŠ©äºå…¨å±€çŠ¶æ€æˆ–å°†å…¶æ‹†åˆ†ä¸ºä¸¤ä¸ªç»„ä»¶ã€‚</p>
<pre><code class="language-js">app.component('modal-button', {
  template: `
    &lt;button @click=&quot;modalOpen = true&quot;&gt;
        Open full screen modal! (With teleport!)
    &lt;/button&gt;

    &lt;teleport to=&quot;body&quot;&gt;
      &lt;div v-if=&quot;modalOpen&quot; class=&quot;modal&quot;&gt;
        &lt;div&gt;
          I'm a teleported modal!
          (My parent is &quot;body&quot;)
          &lt;button @click=&quot;modalOpen = false&quot;&gt;
            Close
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/teleport&gt;
  `,
  data() {
    return {
      modalOpen: false
    }
  }
})
</code></pre>
<h2 id="ç»„ä»¶">ç»„ä»¶</h2>
<ul>
<li>å‡½æ•°å¼ç»„ä»¶</li>
</ul>
<p>åœ¨vue2ä¸­æˆ‘ä»¬å¯èƒ½å› ä¸ºæ€§èƒ½å’Œå¤šæ ¹èŠ‚ç‚¹çš„éœ€æ±‚è€Œä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œå½“åœ¨vue3ä¸­ï¼Œé’ˆå¯¹æ™®é€šç»„ä»¶æ€§èƒ½åšäº†ä¼˜åŒ–ï¼Œå·²ç»å’Œå‡½æ•°ç»„ä»¶æ€§èƒ½ç›¸å·®æ— å‡ ï¼Œè€Œä¸”ä¹Ÿæ”¯æŒå¤šæ ¹èŠ‚ç‚¹ï¼Œå› æ­¤å‡½æ•°å¼ç»„ä»¶çš„ä½¿ç”¨åœºæ™¯ä¸æ˜¯å¾ˆæœ‰å¿…è¦äº†ï¼Œæ‰€ä»¥é’ˆå¯¹å‡½æ•°å¼ç»„ä»¶è¿›è¡Œäº†ä¸€äº›è°ƒæ•´ï¼š</p>
<pre><code class="language-vue">&lt;!-- Vue 2 å‡½æ•°å¼ç»„ä»¶ç¤ºä¾‹ --&gt;
&lt;script&gt;
export default {
  functional: true,
  props: ['level'],
  render(h, { props, data, children }) {
    return h(`h${props.level}`, data, children)
  }
}
&lt;/script&gt;

&lt;!-- Vue 2 å‡½æ•°å¼ç»„ä»¶ç¤ºä¾‹ä½¿ç”¨ &lt;template&gt; --&gt;
&lt;template functional&gt;
  &lt;component
    :is=&quot;`h${props.level}`&quot;
    v-bind=&quot;attrs&quot;
    v-on=&quot;listeners&quot;
  /&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  props: ['level']
}
&lt;/script&gt;
</code></pre>
<p>åœ¨vue3ä¸­åˆ é™¤äº†<code>functional option</code>å’Œ<code>functional attribute</code>,ä¸Šé¢ä¸¤ç§æ–¹å¼ä¸èƒ½åœ¨vue3ä¸­ä½¿ç”¨äº†ã€‚</p>
<p>åœ¨vue3ä¸­å‡½æ•°å¼ç»„ä»¶å³æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>props</code> å’Œ <code>context</code>ã€‚</p>
<pre><code class="language-js">// vue3
import { h } from 'vue'

const DynamicHeading = (props, context) =&gt; {
  return h(`h${props.level}`, context.attrs, context.slots)
}

DynamicHeading.props = ['level']

export default DynamicHeading
</code></pre>
<ul>
<li>åˆ›å»ºå¼‚æ­¥ç»„ä»¶</li>
</ul>
<p>ä»¥å‰å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªPromiseçš„å‡½æ•°æ¥å®šä¹‰å¼‚æ­¥ç»„ä»¶ï¼š</p>
<pre><code class="language-js">// vue2
const asyncModal = () =&gt; import('./Modal.vue');
// æˆ–è€…å¸¦ä¸Šé…ç½®
const asyncModal = {
  component: () =&gt; import('./Modal.vue'),
  delay: 200,
  timeout: 3000,
  error: ErrorComponent,
  loading: LoadingComponent
}
</code></pre>
<p>åœ¨vue3ä¸­ï¼Œæ–°å¢å‘¢ä¸€ä¸ªapiï¼ˆdefineAsyncComponentï¼‰æ¥æ˜¾ç¤ºå®šä¹‰å¼‚æ­¥ç»„ä»¶ã€‚</p>
<pre><code class="language-js">// vue3
import { defineAsyncComponent } from 'vue'
import ErrorComponent from './components/ErrorComponent.vue'
import LoadingComponent from './components/LoadingComponent.vue'

// ä¸å¸¦é€‰é¡¹çš„å¼‚æ­¥ç»„ä»¶
const asyncModal = defineAsyncComponent(() =&gt; import('./Modal.vue'))

// å¸¦é€‰é¡¹çš„å¼‚æ­¥ç»„ä»¶
const asyncModalWithOptions = defineAsyncComponent({
  loader: () =&gt; import('./Modal.vue'),
  delay: 200,
  timeout: 3000,
  errorComponent: ErrorComponent,
  loadingComponent: LoadingComponent
})
</code></pre>
<ul>
<li>æ–°å¢<code>emits</code>é€‰é¡¹ï¼Œå®šä¹‰å’ŒéªŒè¯å‘å‡ºçš„è‡ªå®šä¹‰äº‹ä»¶</li>
</ul>
<pre><code class="language-vue">&lt;!-- vue2 --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;{{ text }}&lt;/p&gt;
    &lt;button v-on:click=&quot;$emit('accepted')&quot;&gt;OK&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
  export default {
    props: ['text']
  }
&lt;/script&gt;
</code></pre>
<p>vue3ä¸­å¢åŠ äº†emitsé€‰é¡¹æ¥æ˜¾ç¤ºå®šä¹‰ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œæœªå£°æ˜ <code>emits</code> çš„äº‹ä»¶ç›‘å¬å™¨éƒ½ä¼šè¢«ç®—å…¥ç»„ä»¶çš„ <code>$attrs</code> å¹¶ç»‘å®šåœ¨ç»„ä»¶çš„æ ¹èŠ‚ç‚¹ä¸Šã€‚</p>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;{{ text }}&lt;/p&gt;
    &lt;button v-on:click=&quot;$emit('accepted')&quot;&gt;OK&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
  export default {
    props: ['text'],
    emits: ['accepted']
  }
&lt;/script&gt;
</code></pre>
<p>emitsè¿˜å¯ä»¥æ”¯æŒå¯¹è‡ªå®šä¹‰äº‹ä»¶è¿›è¡ŒéªŒè¯ï¼Œåªéœ€è¦æ”¹ä¸ºå¯¹è±¡å½¢å¼å³å¯ã€‚</p>
<pre><code class="language-js">emits: {
    // æ²¡æœ‰éªŒè¯å‡½æ•°
    click: null,

    // å¸¦æœ‰éªŒè¯å‡½æ•°
    submit: payload =&gt; {
      if (payload.email &amp;&amp; payload.password) {
        return true
      } else {
        console.warn(`Invalid submit event payload!`)
        return false
      }
    }
  }
</code></pre>
<p>å¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>emits</code> è®°å½•æ¯ä¸ªç»„ä»¶æ‰€è§¦å‘çš„æ‰€æœ‰äº‹ä»¶ï¼Œè€Œä¸”è®°å½•çš„äº‹ä»¶ä¼šæœ‰ä»£ç æç¤ºã€‚</p>
<h2 id="æ¸²æŸ“å‡½æ•°">æ¸²æŸ“å‡½æ•°</h2>
<ul>
<li>
<p>ç»Ÿä¸€æ’æ§½API</p>
<p>ä»¥å‰ï¼Œåœ¨ç»„ä»¶ä¸­è·å–æ’æ§½æ˜¯ä¸¤ä¸ªä¸åŒçš„apiï¼ˆ<code>this.$scopedSlots</code> å’Œ <code>this.$slots</code>ï¼‰ï¼Œç°åœ¨ç»Ÿä¸€ä½¿ç”¨<code>this.$slots</code>ã€‚</p>
</li>
<li>
<p>æ•´åˆ<code>$listeners</code>ã€classã€styleåˆ°<code>$attrs</code></p>
</li>
</ul>
<p>åœ¨vue2æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è®¿é—®<code>attribute</code> å’Œäº‹ä»¶ç›‘å¬å™¨ï¼š</p>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;label&gt;
    &lt;input type=&quot;text&quot; v-bind=&quot;$attrs&quot; v-on=&quot;$listeners&quot; /&gt;
  &lt;/label&gt;
&lt;/template&gt;
&lt;script&gt;
  export default {
    inheritAttrs: false
  }
&lt;/script&gt;
</code></pre>
<p>åœ¨ Vue 3 çš„è™šæ‹Ÿ DOM ä¸­ï¼Œäº‹ä»¶ç›‘å¬å™¨ç°åœ¨åªæ˜¯ä»¥ <code>on</code> ä¸ºå‰ç¼€çš„ attributeï¼Œè¿™æ ·å°±æˆäº† <code>$attrs</code> å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ <code>$listeners</code> è¢«ç§»é™¤äº†ã€‚</p>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;label&gt;
    &lt;input type=&quot;text&quot; v-bind=&quot;$attrs&quot; /&gt;
  &lt;/label&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  inheritAttrs: false
}
&lt;/script&gt;
</code></pre>
<p>åœ¨ Vue 2 çš„è™šæ‹Ÿ DOM å®ç°ä¸­å¯¹ <code>class</code> å’Œ <code>style</code> attribute æœ‰ä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚å› æ­¤ï¼Œå®ƒä»¬<em>ä¸</em>åŒ…å«åœ¨ <code>$attrs</code> ä¸­ï¼ŒVue3ä¸­ç®€åŒ–äº†è¿™éƒ¨åˆ†çš„å¤„ç†ï¼Œç”¨<code>$attrs</code> åŒ…å«<em>æ‰€æœ‰çš„</em> attributeï¼ŒåŒ…æ‹¬<code>class</code>å’Œ<code>style</code>ã€‚</p>
<h2 id="è‡ªå®šä¹‰å…ƒç´ ">è‡ªå®šä¹‰å…ƒç´ </h2>
<ul>
<li>åªèƒ½åœ¨<code>&lt;component&gt;</code>å…ƒç´ ä¸­ä½¿ç”¨<code>is</code>prop</li>
</ul>
<p>åœ¨vue3ä¸­ä¸èƒ½åœ¨æ™®é€šç»„ä»¶å’Œå…ƒç´ ä½¿ç”¨<code>is</code>å±æ€§ï¼Œä»…èƒ½åœ¨<code>component</code>å†…ç½®ç»„ä»¶ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="å…¶ä»–">å…¶ä»–</h2>
<ul>
<li>
<p>ç”Ÿå‘½å‘¨æœŸå˜æ›´</p>
<ul>
<li><code>destroyed</code> ç”Ÿå‘½å‘¨æœŸé€‰é¡¹è¢«é‡å‘½åä¸º <code>unmounted</code></li>
<li><code>beforeDestroy</code> ç”Ÿå‘½å‘¨æœŸé€‰é¡¹è¢«é‡å‘½åä¸º <code>beforeUnmount</code></li>
</ul>
</li>
<li>
<p>è‡ªå®šä¹‰æŒ‡ä»¤ç”Ÿå‘½å‘¨æœŸè°ƒæ•´ï¼Œå’Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸç»Ÿä¸€</p>
<ul>
<li>created - æ–°çš„ï¼åœ¨å…ƒç´ çš„ attribute æˆ–äº‹ä»¶ä¾¦å¬å™¨åº”ç”¨ä¹‹å‰è°ƒç”¨ã€‚</li>
<li>bind â†’ <strong>beforeMount</strong></li>
<li>inserted â†’ <strong>mounted</strong></li>
<li><strong>beforeUpdate</strong>ï¼šæ–°çš„ï¼è¿™æ˜¯åœ¨å…ƒç´ æœ¬èº«æ›´æ–°ä¹‹å‰è°ƒç”¨çš„ï¼Œå¾ˆåƒç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚</li>
<li>update â†’ ç§»é™¤ï¼æœ‰å¤ªå¤šçš„ç›¸ä¼¼ä¹‹å¤„è¦æ›´æ–°ï¼Œæ‰€ä»¥è¿™æ˜¯å¤šä½™çš„ï¼Œè¯·æ”¹ç”¨ <code>updated</code>ã€‚</li>
<li>componentUpdated â†’ <strong>updated</strong></li>
<li><strong>beforeUnmount</strong>ï¼šæ–°çš„ï¼ä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ç±»ä¼¼ï¼Œå®ƒå°†åœ¨å¸è½½å…ƒç´ ä¹‹å‰è°ƒç”¨ã€‚</li>
<li>unbind -&gt; <strong>unmounted</strong></li>
</ul>
</li>
<li>
<p>Mixin åˆå¹¶è¡Œä¸ºå˜æ›´</p>
</li>
</ul>
<p>å½“æ¥è‡ªç»„ä»¶çš„ <code>data()</code> åŠå…¶ mixin æˆ– extends åŸºç±»è¢«åˆå¹¶æ—¶ï¼Œç°åœ¨å°†<em>æµ…å±‚æ¬¡</em>æ‰§è¡Œåˆå¹¶ã€‚</p>
<ul>
<li>è¿‡æ¸¡çš„classåæ›´æ”¹</li>
</ul>
<p>è¿‡æ¸¡ç±»å <code>v-enter</code> ä¿®æ”¹ä¸º <code>v-enter-from</code>ã€è¿‡æ¸¡ç±»å <code>v-leave</code> ä¿®æ”¹ä¸º <code>v-leave-from</code>ã€‚</p>
<ul>
<li>
<p>VNode ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å˜æ›´</p>
<pre><code class="language-vue">&lt;!-- vue2 --&gt;
&lt;template&gt;
  &lt;child-component @hook:updated=&quot;onUpdated&quot;&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;child-component @vnode-updated=&quot;onUpdated&quot;&gt;
&lt;/template&gt;
</code></pre>
</li>
</ul>
<h2 id="åºŸå¼ƒçš„api">åºŸå¼ƒçš„API</h2>
<ul>
<li><code>keyCode</code>ä½œä¸º<code>v-on</code>çš„ä¿®é¥°ç¬¦åŠ<code>config.keyCodes</code>é…ç½®ã€‚</li>
</ul>
<pre><code class="language-vue">&lt;!-- é”®ç ç‰ˆæœ¬ï¼ˆåºŸå¼ƒï¼‰ --&gt;
&lt;input v-on:keyup.13=&quot;submit&quot; /&gt;

&lt;!-- åˆ«åç‰ˆæœ¬ --&gt;
&lt;input v-on:keyup.enter=&quot;submit&quot; /&gt;

&lt;script&gt;
Vue.config.keyCodes = { // åºŸå¼ƒ
  f1: 112
}
&lt;/script&gt;

</code></pre>
<ul>
<li><code>$on</code>ï¼Œ<code>$off</code> å’Œ <code>$once</code> å®ä¾‹æ–¹æ³•å·²è¢«ç§»é™¤ï¼Œç»„ä»¶å®ä¾‹ä¸å†å®ç°äº‹ä»¶è§¦å‘æ¥å£</li>
</ul>
<p>åœ¨vue2ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡EventBuså®ç°ç»„ä»¶é€šä¿¡ï¼š</p>
<pre><code class="language-js">// eventBus.js
const eventBus = new Vue()
export default eventBus
</code></pre>
<pre><code class="language-js">// ChildComponent.vue
import eventBus from './eventBus'
export default {
  mounted() {
    // æ·»åŠ  eventBus ç›‘å¬å™¨
    eventBus.$on('custom-event', () =&gt; {
      console.log('Custom event triggered!')
    })
  },
  beforeDestroy() {
    // ç§»é™¤ eventBus ç›‘å¬å™¨
    eventBus.$off('custom-event')
  }
}
</code></pre>
<pre><code class="language-js">// ParentComponent.vue
import eventBus from './eventBus'
export default {
  methods: {
    callGlobalCustomEvent() {
      eventBus.$emit('custom-event') // å½“ ChildComponent è¢«æŒ‚è½½ï¼Œæ§åˆ¶å°ä¸­å°†æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯
    }
  }
}
</code></pre>
<p>åœ¨vue3ä¸­ï¼Œæ­¤æ–¹å¼ä¸å†æœ‰æ•ˆï¼Œå› ä¸ºå®Œå…¨ç§»é™¤äº† <code>$on</code>ã€<code>$off</code> å’Œ <code>$once</code> æ–¹æ³•ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å®ç°äº†äº‹ä»¶è§¦å‘å™¨æ¥å£çš„å¤–éƒ¨åº“ï¼Œæˆ–è€…ä½¿ç”¨Provideï¼Œå¤æ‚çš„ç›´æ¥ä¸ŠVuexå°±å¯¹äº†ã€‚</p>
<ul>
<li>ä¸å†æ”¯æŒè¿‡æ»¤å™¨</li>
</ul>
<pre><code class="language-vue">&lt;!-- vue2 --&gt;
&lt;template&gt;
  &lt;h1&gt;Bank Account Balance&lt;/h1&gt;
  &lt;p&gt;{{ accountBalance | currencyUSD }}&lt;/p&gt;
&lt;/template&gt;

&lt;script&gt;
  export default {
    props: {
      accountBalance: {
        type: Number,
        required: true
      }
    },
    filters: {
      currencyUSD(value) {
        return '$' + value
      }
    }
  }
&lt;/script&gt;
</code></pre>
<p>åœ¨vue3ä¸­å¯ä»¥ä½¿ç”¨æ–¹æ³•æˆ–è€…è®¡ç®—å±æ€§æ›¿ä»£ï¼š</p>
<pre><code class="language-vue">&lt;!-- vue3 --&gt;
&lt;template&gt;
  &lt;h1&gt;Bank Account Balance&lt;/h1&gt;
  &lt;p&gt;{{ accountInUSD }}&lt;/p&gt;
&lt;/template&gt;

&lt;script&gt;
  export default {
    props: {
      accountBalance: {
        type: Number,
        required: true
      }
    },
    computed: {
      accountInUSD() {
        return '$' + this.accountBalance
      }
    }
  }
&lt;/script&gt;
</code></pre>
<ul>
<li>
<p>åˆ é™¤<code>$children</code>property</p>
<p><code>$children</code> property å·²ç§»é™¤ï¼Œä¸å†æ”¯æŒã€‚å¦‚æœä½ éœ€è¦è®¿é—®å­ç»„ä»¶å®ä¾‹ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <a href="https://v3.cn.vuejs.org/guide/component-template-refs.html#%E6%A8%A1%E6%9D%BF%E5%BC%95%E7%94%A8">$refs</a>ã€‚</p>
</li>
<li>
<p>å…¨å±€å‡½æ•° <code>set</code> å’Œ <code>delete</code> ä»¥åŠå®ä¾‹æ–¹æ³• <code>$set</code> å’Œ <code>$delete</code>ã€‚åŸºäºä»£ç†çš„å˜åŒ–æ£€æµ‹ä¸å†éœ€è¦å®ƒä»¬äº†ã€‚</p>
</li>
</ul>
<p>å½“ç„¶ï¼Œä¸Šé¢çš„åªæ˜¯å¼€èƒƒèœï¼Œæ¥ä¸‹æ¥çš„æ‰æ˜¯æˆ‘ä»¬æœ€å€¼å¾—å…³æ³¨çš„æ–°ç‰¹æ€§ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://gitee.com/letwrong/Picture/raw/master/20210823173734.jpg" alt="" loading="lazy"></figure>
<h1 id="ç»„åˆå¼api">ç»„åˆå¼Api</h1>
<p>ä¸ºäº†è§£å†³æˆ‘ä»¬å‰é¢è¯´çš„é€»è¾‘å¤ç”¨å’Œä»£ç ç»„ç»‡çš„é—®é¢˜ï¼Œvue3æ¨å‡ºäº†æ–°çš„ä»£ç ç¼–å†™æ–¹å¼ï¼Œè¿™ä¸ªvue3æœ€é‡è¦çš„ç‰¹æ€§ï¼Œä¹Ÿæ˜¯æœªæ¥ç¼–å†™vueçš„ä¸»è¦è¶‹åŠ¿ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ˜¾ç¤ºæŸä¸ªç”¨æˆ·çš„ä»“åº“åˆ—è¡¨çš„è§†å›¾ï¼ŒåŒæ—¶å¸¦æœ‰æœç´¢å’Œç­›é€‰åŠŸèƒ½ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">// src/components/UserRepositories.vue

export default {
  components: { RepositoriesFilters, RepositoriesSortBy, RepositoriesList },
  props: {
    user: {
      type: String,
      required: true
    }
  },
  data () {
    return {
      repositories: [], // 1
      filters: { ... }, // 3
      searchQuery: '' // 2
    }
  },
  computed: {
    filteredRepositories () { ... }, // 3
    repositoriesMatchingSearchQuery () { ... }, // 2
  },
  watch: {
    user: 'getUserRepositories' // 1
  },
  methods: {
    getUserRepositories () {
      // ä½¿ç”¨ `this.user` è·å–ç”¨æˆ·ä»“åº“
    }, // 1
    updateFilters () { ... }, // 3
  },
  mounted () {
    this.getUserRepositories() // 1
  }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒæŒ‰optionç»„ç»‡ä»£ç ï¼ŒåŠŸèƒ½é€»è¾‘ç‚¹æ˜¯ç¢ç‰‡åŒ–çš„åˆ†æ•£åœ¨å„ä¸ªç»„ä»¶é€‰é¡¹ä¸­ï¼Œç‰¹åˆ«æ˜¯é‡åˆ°ä¸€äº›å†…å®¹è¾ƒå¤šçš„ç»„ä»¶ï¼Œéœ€è¦åœ¨å„ä¸ªé€‰é¡¹ä¸­åå¤è·³è½¬ï¼Œé˜…è¯»å’Œä¹¦å†™ä»£ç å°†æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„äº‹æƒ…ï¼Œå¤§å¤§é™ä½äº†ç»„ä»¶çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<p>å…¶å®ï¼Œåœ¨å¼€å‘å’Œé˜…è¯»ç»„ä»¶ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´å¤šæ˜¯å…³æ³¨çš„åŠŸèƒ½ç‚¹ï¼Œè€Œä¸æ˜¯å»å…³æ³¨ç”¨äº†é‚£äº›optionsï¼Œè¿™æ­£æ˜¯ç»„åˆå¼apiè§£å†³çš„é—®é¢˜ã€‚</p>
<pre><code class="language-js">// src/composables/useUserRepositories.js

import { fetchUserRepositories } from '@/api/repositories'
import { ref, onMounted, watch } from 'vue'

export default function useUserRepositories(user) {
  const repositories = ref([])
  const getUserRepositories = async () =&gt; {
    repositories.value = await fetchUserRepositories(user.value)
  }

  onMounted(getUserRepositories)
  watch(user, getUserRepositories)

  return {
    repositories,
    getUserRepositories
  }
}
</code></pre>
<pre><code class="language-js">// src/composables/useRepositoryNameSearch.js

import { ref, computed } from 'vue'

export default function useRepositoryNameSearch(repositories) {
  const searchQuery = ref('')
  const repositoriesMatchingSearchQuery = computed(() =&gt; {
    return repositories.value.filter(repository =&gt; {
      return repository.name.includes(searchQuery.value)
    })
  })

  return {
    searchQuery,
    repositoriesMatchingSearchQuery
  }
}
</code></pre>
<pre><code class="language-js">// src/components/UserRepositories.vue
import { toRefs } from 'vue'
import useUserRepositories from '@/composables/useUserRepositories'
import useRepositoryNameSearch from '@/composables/useRepositoryNameSearch'
import useRepositoryFilters from '@/composables/useRepositoryFilters'

export default {
  components: { RepositoriesFilters, RepositoriesSortBy, RepositoriesList },
  props: {
    user: {
      type: String,
      required: true
    }
  },
  setup(props) {
    const { user } = toRefs(props)

    const { repositories, getUserRepositories } = useUserRepositories(user)

    const {
      searchQuery,
      repositoriesMatchingSearchQuery
    } = useRepositoryNameSearch(repositories)

    const {
      filters,
      updateFilters,
      filteredRepositories
    } = useRepositoryFilters(repositoriesMatchingSearchQuery)

    return {
      // å› ä¸ºæˆ‘ä»¬å¹¶ä¸å…³å¿ƒæœªç»è¿‡æ»¤çš„ä»“åº“
      // æˆ‘ä»¬å¯ä»¥åœ¨ `repositories` åç§°ä¸‹æš´éœ²è¿‡æ»¤åçš„ç»“æœ
      repositories: filteredRepositories,
      getUserRepositories,
      searchQuery,
      filters,
      updateFilters
    }
  }
}
</code></pre>
<p>ç»„åˆå¼APIåˆ†ç¦»äº†ç»„ä»¶çš„é€»è¾‘å…³æ³¨ç‚¹ï¼Œæ›´å…·ç»„ç»‡æ€§ï¼Œä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¹Ÿæ›´å¥½ã€‚è€Œä¸”å¯ä»¥å°†å¯å¤ç”¨çš„é€»è¾‘æŠ½ç¦»æˆHooksï¼Œå…·æœ‰æ›´å¥½çš„å¯å¤ç”¨æ€§ã€‚</p>
<figure data-type="image" tabindex="6"><img src="https://gitee.com/letwrong/Picture/raw/master/20210824102437.png" alt="" loading="lazy"></figure>
<p>ç”±äºç»„åˆå¼APIçš„ç‰¹æ®Šæ€§ï¼Œéœ€è¦ä½¿ç”¨æ–°çš„APIï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™äº›APIã€‚</p>
<h2 id="setup">setup</h2>
<p>setupæ˜¯ç»„åˆå¼APIçš„å…¥å£ï¼Œæ‰€æœ‰çš„å†…å®¹éƒ½éœ€è¦åŒ…å«åœ¨å…¶ä¸­ï¼Œå®ƒä»…åœ¨ç»„ä»¶åˆ›å»º<strong>ä¹‹å‰</strong>æ‰§è¡Œ<strong>ä¸€æ¬¡</strong>ï¼Œæ‰€ä»¥æ­¤æ—¶thiså¹¶ä¸æ˜¯æŒ‡å‘å½“å‰ç»„ä»¶å®ä¾‹ã€‚</p>
<pre><code class="language-js">setup(props,context){
  const { attrs, slots, emit } = context;
	// ...
}
</code></pre>
<h3 id="å‚æ•°">å‚æ•°</h3>
<ul>
<li><code>{Data} props</code>ï¼šæ¥æ”¶åˆ°çš„propsæ•°æ®ï¼Œæ˜¯å“åº”å¼çš„ã€‚</li>
<li><code>{SetupContext} context</code>ï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ç»„ä»¶éœ€è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒåŒ…å«<code>attrs</code>ã€<code>slots</code>ã€<code>emit</code>ã€‚</li>
</ul>
<h3 id="è¿”å›å€¼">è¿”å›å€¼</h3>
<ul>
<li>å¦‚æœè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡çš„ property ä»¥åŠä¼ é€’ç»™ <code>setup</code> çš„ <code>props</code> å‚æ•°ä¸­çš„ property å°±éƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­è®¿é—®åˆ°ã€‚</li>
</ul>
<pre><code class="language-vue">&lt;!-- MyBook.vue --&gt;
&lt;template&gt;
  &lt;div&gt;{{ collectionName }}: {{ readersNumber }} {{ book.title }}&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
  import { ref, reactive } from 'vue'

  export default {
    props: {
      collectionName: String
    },
    setup(props) {
      const readersNumber = ref(0)
      const book = reactive({ title: 'Vue 3 Guide' })

      // æš´éœ²ç»™ template
      return {
        readersNumber,
        book
      }
    }
  }
&lt;/script&gt;
</code></pre>
<ul>
<li>å¦‚æœè¿”å›ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥ç›´æ¥ä½¿ç”¨åœ¨åŒä¸€ä½œç”¨åŸŸä¸­å£°æ˜çš„å“åº”å¼çŠ¶æ€ã€‚</li>
</ul>
<pre><code class="language-js">// MyBook.vue

import { h, ref, reactive } from 'vue'

export default {
  setup() {
    const readersNumber = ref(0)
    const book = reactive({ title: 'Vue 3 Guide' })
    // è¯·æ³¨æ„è¿™é‡Œæˆ‘ä»¬éœ€è¦æ˜¾å¼è°ƒç”¨ ref çš„ value
    return () =&gt; h('div', [readersNumber.value, book.title])
  }
}
</code></pre>
<h2 id="ç”Ÿå‘½å‘¨æœŸé’©å­">ç”Ÿå‘½å‘¨æœŸé’©å­</h2>
<p>ä¸ºäº†ä½¿ç»„åˆå¼ API çš„åŠŸèƒ½å’Œé€‰é¡¹å¼ API ä¸€æ ·å®Œæ•´ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§åœ¨ <code>setup</code> ä¸­æ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­çš„æ–¹æ³•ã€‚ç»„åˆå¼ API ä¸Šçš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸é€‰é¡¹å¼ API çš„åç§°ç›¸åŒï¼Œä½†å‰ç¼€ä¸º <code>on</code>ï¼šå³ <code>mounted</code> çœ‹èµ·æ¥ä¼šåƒ <code>onMounted</code>ã€‚</p>
<pre><code class="language-js">import { onMounted, onUpdated, onUnmounted } from 'vue'

const MyComponent = {
  setup() {
    onMounted(() =&gt; {
      console.log('mounted!')
    })
    onUpdated(() =&gt; {
      console.log('updated!')
    })
    onUnmounted(() =&gt; {
      console.log('unmounted!')
    })
  }
}
</code></pre>
<p>setupä»£æ›¿äº†<code>beforeCreate</code>å’Œ<code>created</code>ï¼Œå¯¹æ¯”å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>é€‰é¡¹å¼ API</th>
<th>Hook inside <code>setup</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>beforeCreate</code></td>
<td>Not needed*</td>
</tr>
<tr>
<td><code>created</code></td>
<td>Not needed*</td>
</tr>
<tr>
<td><code>beforeMount</code></td>
<td><code>onBeforeMount</code></td>
</tr>
<tr>
<td><code>mounted</code></td>
<td><code>onMounted</code></td>
</tr>
<tr>
<td><code>beforeUpdate</code></td>
<td><code>onBeforeUpdate</code></td>
</tr>
<tr>
<td><code>updated</code></td>
<td><code>onUpdated</code></td>
</tr>
<tr>
<td><code>beforeUnmount</code></td>
<td><code>onBeforeUnmount</code></td>
</tr>
<tr>
<td><code>unmounted</code></td>
<td><code>onUnmounted</code></td>
</tr>
<tr>
<td><code>errorCaptured</code></td>
<td><code>onErrorCaptured</code></td>
</tr>
<tr>
<td><code>renderTracked</code></td>
<td><code>onRenderTracked</code></td>
</tr>
<tr>
<td><code>renderTriggered</code></td>
<td><code>onRenderTriggered</code></td>
</tr>
<tr>
<td><code>activated</code></td>
<td><code>onActivated</code></td>
</tr>
<tr>
<td><code>deactivated</code></td>
<td><code>onDeactivated</code></td>
</tr>
</tbody>
</table>
<h2 id="å“åº”å¼">å“åº”å¼</h2>
<p>åœ¨vue3ä¸­ï¼Œä½¿ç”¨äº†<code>Proxy</code>ä»£æ›¿äº†<code>Object.defineProperty</code>ï¼Œä½¿ Vue 3 é¿å…äº† Vue æ—©æœŸç‰ˆæœ¬ä¸­å­˜åœ¨çš„ä¸€äº›å“åº”æ€§é—®é¢˜ã€‚</p>
<p>å½“æˆ‘ä»¬ä»ä¸€ä¸ªç»„ä»¶çš„ <code>data</code> å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡æ—¶ï¼ŒVue ä¼šå°†è¯¥å¯¹è±¡åŒ…è£¹åœ¨ä¸€ä¸ªå¸¦æœ‰ <code>get</code> å’Œ <code>set</code> å¤„ç†ç¨‹åºçš„ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy</a> ä¸­ã€‚</p>
<p>ä¸¾ä¸ªğŸŒ°ï¼š</p>
<pre><code class="language-js">const dinner = {
  meal: 'tacos'
}

const handler = {
  get(target, property, receiver) { // æ•æ‰å™¨
    track(target, property)  // è·Ÿè¸ªpropertyè¯»å–ï¼Œæ”¶é›†ä¾èµ–
    return Reflect.get(...arguments) // Reflectå°†thisç»‘å®šåˆ°Proxy
  },
  set(target, property, value, receiver) {
    trigger(target, property) // æ‰§è¡Œå‰¯ä½œç”¨ä¾èµ–é¡¹
    return Reflect.set(...arguments)
  }
}

const proxy = new Proxy(dinner, handler)
console.log(proxy.meal)

// tacos
</code></pre>
<ol>
<li><strong>å½“ä¸€ä¸ªå€¼è¢«è¯»å–æ—¶è¿›è¡Œè¿½è¸ª</strong>ï¼šproxy çš„ <code>get</code> å¤„ç†å‡½æ•°ä¸­ <code>track</code> å‡½æ•°è®°å½•äº†è¯¥ property å’Œå½“å‰å‰¯ä½œç”¨ã€‚</li>
<li><strong>å½“æŸä¸ªå€¼æ”¹å˜æ—¶è¿›è¡Œæ£€æµ‹</strong>ï¼šåœ¨ proxy ä¸Šè°ƒç”¨ <code>set</code> å¤„ç†å‡½æ•°ã€‚</li>
<li><strong>é‡æ–°è¿è¡Œä»£ç æ¥è¯»å–åŸå§‹å€¼</strong>ï¼š<code>trigger</code> å‡½æ•°æŸ¥æ‰¾å“ªäº›å‰¯ä½œç”¨ä¾èµ–äºè¯¥ property å¹¶æ‰§è¡Œå®ƒä»¬ã€‚</li>
</ol>
<p>è¯¥è¢«ä»£ç†çš„å¯¹è±¡å¯¹äºç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯åœ¨å†…éƒ¨ï¼Œå®ƒä»¬ä½¿ Vue èƒ½å¤Ÿåœ¨ property çš„å€¼è¢«è®¿é—®æˆ–ä¿®æ”¹çš„æƒ…å†µä¸‹è¿›è¡Œä¾èµ–è·Ÿè¸ªå’Œå˜æ›´é€šçŸ¥ã€‚</p>
<p>é‚£ä¹ˆç»„ä»¶æ˜¯å¦‚ä½•è®©æ¸²æŸ“å“åº”æ•°æ®å˜åŒ–çš„å‘¢ï¼Ÿ</p>
<p>ç»„ä»¶çš„æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ª <a href="https://v3.cn.vuejs.org/guide/render-function.html"><code>render</code></a> å‡½æ•°ï¼Œå®ƒç”¨æ¥åˆ›å»º <a href="https://v3.cn.vuejs.org/guide/render-function.html#%E8%99%9A%E6%8B%9F-dom-%E6%A0%91">VNodes</a>ï¼Œæè¿°è¯¥ç»„ä»¶åº”è¯¥å¦‚ä½•è¢«æ¸²æŸ“ã€‚è¿™ä¸ªrenderå‡½æ•°è¢«åŒ…è£¹åœ¨ä¸€ä¸ªå‰¯ä½œç”¨ä¸­ï¼Œå…è®¸ Vue åœ¨è¿è¡Œæ—¶è·Ÿè¸ªè¢«â€œè§¦è¾¾â€çš„ propertyï¼Œå½“propertyå˜åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„å‰¯ä½œç”¨ï¼Œä»è€Œæ‰§è¡Œrenderé‡æ–°æ¸²æŸ“ã€‚å½“ç„¶åœ¨æ¸²æŸ“å¹¶ä¸ä¼šæ•´ä¸ªé‡æ–°æ¸²æŸ“ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¼˜åŒ–æ‰‹æ®µï¼Œç½‘ä¸Šèµ„æ–™å¾ˆå¤šï¼Œè¿™é‡Œä¸å±•å¼€è®²ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å‡ ä¸ªå¸¸ç”¨çš„å“åº”å¼APIã€‚</p>
<h3 id="ref">ref</h3>
<pre><code class="language-ts">interface Ref&lt;T&gt; {
  value: T
}
function ref&lt;T&gt;(value: T): Ref&lt;T&gt;
</code></pre>
<p>æ¥å—ä¸€ä¸ªå†…éƒ¨å€¼å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼ä¸”å¯å˜çš„ ref å¯¹è±¡ã€‚ref å¯¹è±¡å…·æœ‰æŒ‡å‘å†…éƒ¨å€¼çš„å•ä¸ª property <code>.value</code>ã€‚</p>
<pre><code class="language-js">import { ref } from 'vue'

const counter = ref&lt;number&gt;(0)

console.log(counter) // { value: 0 }
console.log(counter.value) // 0

counter.value++
console.log(counter.value) // 1
</code></pre>
<p>å› ä¸ºåœ¨ JavaScript ä¸­ï¼Œ<code>Number</code> æˆ– <code>String</code> ç­‰åŸºæœ¬ç±»å‹æ˜¯é€šè¿‡å€¼è€Œéå¼•ç”¨ä¼ é€’çš„ï¼Œåœ¨ä»»ä½•å€¼å‘¨å›´éƒ½æœ‰ä¸€ä¸ªå°è£…å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ä¸­å®‰å…¨åœ°ä¼ é€’å®ƒï¼Œè€Œä¸å¿…æ‹…å¿ƒåœ¨æŸä¸ªåœ°æ–¹å¤±å»å®ƒçš„å“åº”æ€§ã€‚</p>
<figure data-type="image" tabindex="7"><img src="https://gitee.com/letwrong/Picture/raw/master/20210824224551.gif" alt="pass-by-reference-vs-pass-by-value-animation" loading="lazy"></figure>
<p><em>æ³¨æ„ï¼šrefåµŒå¥—åœ¨å“åº”å¼å¯¹è±¡ï¼ˆå¦‚reactiveã€readonlyï¼‰æˆ–è€…ç”¨åœ¨æ¨¡æ¿ä¸­ï¼Œå°†è‡ªåŠ¨è§£åŒ…</em>ã€‚</p>
<h3 id="reactive">reactive</h3>
<pre><code class="language-ts">function reactive&lt;T extends object&gt;(target: T): UnwrapNestedRefs&lt;T&gt;
</code></pre>
<p>è¿”å›å¯¹è±¡çš„å“åº”å¼å‰¯æœ¬ï¼Œå³ä¸€ä¸ªæ·±å±‚é€’å½’è½¬æ¢çš„proxyå¯¹è±¡ã€‚</p>
<pre><code class="language-js">import { reactive } from 'vue'
interface IState{
  count:number
}
// state ç°åœ¨æ˜¯ä¸€ä¸ªå“åº”å¼çš„çŠ¶æ€
const state = reactive&lt;IState&gt;({
  count: 0,
})
</code></pre>
<p><strong>refå’Œreactive</strong>ï¼š</p>
<ul>
<li>ä¸€èˆ¬åŸºç¡€æ•°æ®ç±»å‹ä½¿ç”¨refï¼Œå¯¹è±¡ä½¿ç”¨reactive</li>
<li>å¦‚æœå°†å¯¹è±¡åˆ†é…ä¸º ref å€¼ï¼Œåˆ™é€šè¿‡ <a href="https://v3.cn.vuejs.org/api/basic-reactivity.html#reactive">reactive</a> æ–¹æ³•ä½¿è¯¥å¯¹è±¡å…·æœ‰é«˜åº¦çš„å“åº”å¼ã€‚</li>
</ul>
<h3 id="readonly">readonly</h3>
<p>æ¥å—ä¸€ä¸ªå¯¹è±¡ (å“åº”å¼æˆ–çº¯å¯¹è±¡) æˆ– <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref">ref</a> å¹¶è¿”å›åŸå§‹å¯¹è±¡çš„åªè¯»ä»£ç†ã€‚åªè¯»ä»£ç†æ˜¯æ·±å±‚çš„ï¼šä»»ä½•è¢«è®¿é—®çš„åµŒå¥— property ä¹Ÿæ˜¯åªè¯»çš„ã€‚</p>
<pre><code class="language-js">const original = reactive({ count: 0 })

const copy = readonly(original)

watchEffect(() =&gt; {
  // ç”¨äºå“åº”æ€§è¿½è¸ª
  console.log(copy.count)
})

// å˜æ›´ original ä¼šè§¦å‘ä¾èµ–äºå‰¯æœ¬çš„ä¾¦å¬å™¨
original.count++

// å˜æ›´å‰¯æœ¬å°†å¤±è´¥å¹¶å¯¼è‡´è­¦å‘Š
copy.count++ // è­¦å‘Š!
</code></pre>
<h3 id="unref">unref</h3>
<p>å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ª <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref"><code>ref</code></a>ï¼Œåˆ™è¿”å›å†…éƒ¨å€¼ï¼Œå¦åˆ™è¿”å›å‚æ•°æœ¬èº«ã€‚è¿™æ˜¯ <code>val = isRef(val) ? val.value : val</code> çš„è¯­æ³•ç³–å‡½æ•°ã€‚</p>
<pre><code class="language-ts">function useFoo(x: number | Ref&lt;number&gt;) {
  const unwrapped = unref(x) // unwrapped ç°åœ¨ä¸€å®šæ˜¯æ•°å­—ç±»å‹
}
</code></pre>
<h3 id="toref">toRef</h3>
<p>å¯ä»¥ç”¨æ¥ä¸ºæºå“åº”å¼å¯¹è±¡ä¸Šçš„æŸä¸ª property æ–°åˆ›å»ºä¸€ä¸ª <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref"><code>ref</code></a>,å®ƒä¼šä¿æŒå¯¹å…¶æº property çš„å“åº”å¼è¿æ¥ã€‚</p>
<pre><code class="language-js">const state = reactive({
  foo: 1,
  bar: 2
})

const fooRef = toRef(state, 'foo')

fooRef.value++
console.log(state.foo) // 2

state.foo++
console.log(fooRef.value) // 3
</code></pre>
<h3 id="torefs">toRefs</h3>
<p>å°†å“åº”å¼å¯¹è±¡è½¬æ¢ä¸ºæ™®é€šå¯¹è±¡ï¼Œå…¶ä¸­ç»“æœå¯¹è±¡çš„æ¯ä¸ª property éƒ½æ˜¯æŒ‡å‘åŸå§‹å¯¹è±¡ç›¸åº” property çš„ <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref"><code>ref</code></a>ã€‚</p>
<pre><code class="language-js">function useFeatureX() {
  const state = reactive({
    foo: 1,
    bar: 2
  })

  // æ“ä½œ state çš„é€»è¾‘

  // è¿”å›æ—¶è½¬æ¢ä¸ºref
  return toRefs(state)
}

export default {
  setup() {
    // å¯ä»¥åœ¨ä¸å¤±å»å“åº”æ€§çš„æƒ…å†µä¸‹è§£æ„
    const { foo, bar } = useFeatureX()

    return {
      foo,
      bar
    }
  }
}
</code></pre>
<p>è¦è¯†åˆ«æ•°æ®æ˜¯å¦ä½¿ç”¨ä¸Šè¿°apiå¤„ç†è¿‡ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›apiï¼šisRef<code>ã€</code>isProxy<code>ã€</code>isReactive<code>ã€</code>isReadonly`ã€‚</p>
<h3 id="computed">computed</h3>
<pre><code class="language-ts">// åªè¯»çš„
function computed&lt;T&gt;(
  getter: () =&gt; T,
  debuggerOptions?: DebuggerOptions
): Readonly&lt;Ref&lt;Readonly&lt;T&gt;&gt;&gt;

// å¯å†™çš„
function computed&lt;T&gt;(
  options: {
    get: () =&gt; T
    set: (value: T) =&gt; void
  },
  debuggerOptions?: DebuggerOptions
): Ref&lt;T&gt;
interface DebuggerOptions {
  onTrack?: (event: DebuggerEvent) =&gt; void
  onTrigger?: (event: DebuggerEvent) =&gt; void
}
interface DebuggerEvent {
  effect: ReactiveEffect
  target: any
  type: OperationTypes
  key: string | symbol | undefined
}
</code></pre>
<ul>
<li>æ¥å—ä¸€ä¸ª getter å‡½æ•°ï¼Œå¹¶æ ¹æ® getter çš„è¿”å›å€¼è¿”å›ä¸€ä¸ªä¸å¯å˜çš„å“åº”å¼ <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref">ref</a> å¯¹è±¡ã€‚</li>
</ul>
<pre><code class="language-js">const count = ref(1)
const plusOne = computed(() =&gt; count.value + 1)

console.log(plusOne.value) // 2

plusOne.value++ // é”™è¯¯
</code></pre>
<ul>
<li>æ¥å—ä¸€ä¸ªå…·æœ‰ <code>get</code> å’Œ <code>set</code> å‡½æ•°çš„å¯¹è±¡ï¼Œç”¨æ¥åˆ›å»ºå¯å†™çš„ ref å¯¹è±¡ã€‚</li>
</ul>
<pre><code class="language-js">const count = ref(1)
const plusOne = computed({
  get: () =&gt; count.value + 1,
  set: val =&gt; {
    count.value = val - 1
  }
})

plusOne.value = 1
console.log(count.value) // 0
</code></pre>
<h3 id="watcheffect">watchEffect</h3>
<pre><code class="language-ts">function watchEffect(
  effect: (onInvalidate: InvalidateCbRegistrator) =&gt; void,
  options?: WatchEffectOptions
): StopHandle

interface WatchEffectOptions {
  flush?: 'pre' | 'post' | 'sync' // é»˜è®¤ï¼š'pre'
  onTrack?: (event: DebuggerEvent) =&gt; void
  onTrigger?: (event: DebuggerEvent) =&gt; void
}

interface DebuggerEvent {
  effect: ReactiveEffect
  target: any
  type: OperationTypes
  key: string | symbol | undefined
}

type InvalidateCbRegistrator = (invalidate: () =&gt; void) =&gt; void

type StopHandle = () =&gt; void
</code></pre>
<p>ç«‹å³æ‰§è¡Œä¼ å…¥çš„ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶å“åº”å¼è¿½è¸ªå…¶ä¾èµ–ï¼Œå¹¶åœ¨å…¶ä¾èµ–å˜æ›´æ—¶é‡æ–°è¿è¡Œè¯¥å‡½æ•°ã€‚</p>
<pre><code class="language-js">const count = ref(0)

watchEffect(() =&gt; console.log(count.value))
// -&gt; logs 0

setTimeout(() =&gt; {
  count.value++
  // -&gt; logs 1
}, 100)
</code></pre>
<ul>
<li>åœæ­¢ä¾¦å¬</li>
</ul>
<p>å½“ <code>watchEffect</code> åœ¨ç»„ä»¶çš„ <a href="https://v3.cn.vuejs.org/guide/composition-api-setup.html">setup()</a> å‡½æ•°æˆ–<a href="https://v3.cn.vuejs.org/guide/composition-api-lifecycle-hooks.html">ç”Ÿå‘½å‘¨æœŸé’©å­</a>è¢«è°ƒç”¨æ—¶ï¼Œä¾¦å¬å™¨ä¼šè¢«é“¾æ¥åˆ°è¯¥ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶åœ¨ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨åœæ­¢ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ˜¾å¼è°ƒç”¨è¿”å›å€¼ä»¥åœæ­¢ä¾¦å¬ï¼š</p>
<pre><code class="language-js">const stop = watchEffect(() =&gt; {
  /* ... */
})
// later
stop()
</code></pre>
<ul>
<li>æ¸…é™¤å‰¯ä½œç”¨</li>
</ul>
<p>æœ‰æ—¶å‰¯ä½œç”¨å‡½æ•°ä¼šæ‰§è¡Œä¸€äº›å¼‚æ­¥çš„å‰¯ä½œç”¨ï¼Œè¿™äº›å“åº”éœ€è¦åœ¨å…¶å¤±æ•ˆæ—¶æ¸…é™¤ã€‚æ‰€ä»¥ä¾¦å¬å‰¯ä½œç”¨ä¼ å…¥çš„å‡½æ•°å¯ä»¥æ¥æ”¶ä¸€ä¸ª <code>onInvalidate</code> å‡½æ•°ä½œå…¥å‚ï¼Œç”¨æ¥æ³¨å†Œæ¸…ç†å¤±æ•ˆæ—¶çš„å›è°ƒã€‚å½“ä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶ï¼Œè¿™ä¸ªå¤±æ•ˆå›è°ƒä¼šè¢«è§¦å‘ï¼š</p>
<ol>
<li>
<p>å‰¯ä½œç”¨å³å°†é‡æ–°æ‰§è¡Œæ—¶</p>
</li>
<li>
<p>ä¾¦å¬å™¨è¢«åœæ­¢ (å¦‚æœåœ¨ <code>setup()</code> æˆ–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ä¸­ä½¿ç”¨äº† <code>watchEffect</code>ï¼Œåˆ™åœ¨ç»„ä»¶å¸è½½æ—¶)</p>
</li>
</ol>
<pre><code class="language-js">watchEffect(onInvalidate =&gt; {
  const token = performAsyncOperation(id.value)
  onInvalidate(() =&gt; {
    // id has changed or watcher is stopped.
    // invalidate previously pending async operation
    token.cancel()
  })
})
</code></pre>
<p>å¦å¤–å¯ä»¥ä½¿ç”¨flush optionæˆ–è€…watchPostEffect<code>å’Œ</code>watchSyncEffectæ¥è°ƒæ•´å…¶åˆ·æ–°æ—¶æœºã€‚</p>
<h3 id="watch">watch</h3>
<pre><code class="language-ts">// ä¾¦å¬å•ä¸€æº
function watch&lt;T&gt;(
  source: WatcherSource&lt;T&gt;,
  callback: (
    value: T,
    oldValue: T,
    onInvalidate: InvalidateCbRegistrator
  ) =&gt; void,
  options?: WatchOptions
): StopHandle

// ä¾¦å¬å¤šä¸ªæº
function watch&lt;T extends WatcherSource&lt;unknown&gt;[]&gt;(
  sources: T
  callback: (
    values: MapSources&lt;T&gt;,
    oldValues: MapSources&lt;T&gt;,
    onInvalidate: InvalidateCbRegistrator
  ) =&gt; void,
  options? : WatchOptions
): StopHandle

type WatcherSource&lt;T&gt; = Ref&lt;T&gt; | (() =&gt; T)

type MapSources&lt;T&gt; = {
  [K in keyof T]: T[K] extends WatcherSource&lt;infer V&gt; ? V : never
}

// å‚è§ `watchEffect` å…±äº«é€‰é¡¹çš„ç±»å‹å£°æ˜
interface WatchOptions extends WatchEffectOptions {
  immediate?: boolean // é»˜è®¤ï¼šfalse
  deep?: boolean
}
</code></pre>
<p><code>watch</code> éœ€è¦ä¾¦å¬ç‰¹å®šçš„æ•°æ®æºï¼Œå¹¶åœ¨å•ç‹¬çš„å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œå‰¯ä½œç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿæ˜¯æƒ°æ€§çš„â€”â€”å³å›è°ƒä»…åœ¨ä¾¦å¬æºå‘ç”Ÿå˜åŒ–æ—¶è¢«è°ƒç”¨ã€‚</p>
<ul>
<li>ä¸ <a href="https://v3.cn.vuejs.org/api/computed-watch-api.html#watcheffect">watchEffect</a> ç›¸æ¯”ï¼Œ<code>watch</code> å…è®¸æˆ‘ä»¬ï¼š
<ul>
<li>æƒ°æ€§åœ°æ‰§è¡Œå‰¯ä½œç”¨ï¼›</li>
<li>æ›´å…·ä½“åœ°è¯´æ˜åº”è§¦å‘ä¾¦å¬å™¨é‡æ–°è¿è¡Œçš„çŠ¶æ€ï¼›</li>
<li>è®¿é—®è¢«ä¾¦å¬çŠ¶æ€çš„å…ˆå‰å€¼å’Œå½“å‰å€¼ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="language-js">// ä¾¦å¬ä¸€ä¸ª getter
const state = reactive({ count: 0 })
watch(
  () =&gt; state.count,
  (count, prevCount) =&gt; {
    /* ... */
  }
)

// ç›´æ¥ä¾¦å¬ä¸€ä¸ª ref
const count = ref(0)
watch(count, (count, prevCount) =&gt; {
  /* ... */
})
</code></pre>
<pre><code class="language-js">watch([fooRef, barRef], ([foo, bar], [prevFoo, prevBar]) =&gt; {
  /* ... */
})
</code></pre>
<p>å½“ç„¶ï¼Œå‰é¢åªæ˜¯ä»‹ç»äº†å¸¸ç”¨çš„APIï¼Œæ›´å¤šçš„è¯·æŸ¥çœ‹<a href="https://v3.cn.vuejs.org/api/reactivity-api.html">å“åº”å¼API</a>ã€‚</p>
<h2 id="å¼Šç«¯">å¼Šç«¯</h2>
<p>å½“ç„¶ç»„åˆå¼APIä¹Ÿå¹¶ä¸æ˜¯é“¶å¼¹ï¼Œè‡³å°‘ç›®å‰æ¥è¯´ä¸æ˜¯ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚</p>
<ul>
<li>Ref çš„å¿ƒæ™ºè´Ÿæ‹…</li>
</ul>
<p>è¯»å†™refå¿…é¡»å¸¦ä¸Š.valueï¼Œè¯­æ³•å†—ä½™ï¼Œç›®å‰è¿˜æ²¡æœ‰ç¡®å®šçš„æ–¹æ¡ˆæ¥è§£å†³æ­¤é—®é¢˜ã€‚ä¸è¿‡å°¤å¤§ç»™å‡ºäº†refSuger2ææ¡ˆï¼Œå°±çœ‹åç»­ç¤¾åŒºè®¤å¯åº¦æ€ä¹ˆæ ·äº†ã€‚</p>
<pre><code class="language-js">&lt;script setup&gt;
  // declaring a variable that compiles to a ref
  let count = $ref(1)

  console.log(count) // 1

  function inc() {
    // the variable can be used like a plain value
    count++
  }
&lt;/script&gt;

&lt;template&gt;
  &lt;button @click=&quot;inc&quot;&gt;{{ count }}&lt;/button&gt;
&lt;/template&gt;
</code></pre>
<ul>
<li><s>éš¾çœ‹å†—é•¿çš„è¿”å›è¯­å¥</s></li>
</ul>
<p><code>setup()</code> çš„è¿”å›è¯­å¥å˜å¾—å†—é•¿ï¼Œåƒæ˜¯é‡å¤åŠ³åŠ¨ï¼Œè€Œä¸”è¿˜æ˜¯å­˜åœ¨ä»£ç ä¸Šä¸‹æ¨ªè·³é—®ã€‚</p>
<p>åœ¨vue3.2æä¾›äº†SetupScriptè¯­æ³•ç³–ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ã€‚</p>
<ul>
<li>éœ€è¦æ›´å¤šçš„è‡ªæˆ‘å…‹åˆ¶</li>
</ul>
<p>è™½ç„¶ç»„åˆå¼ API åœ¨ä»£ç ç»„ç»‡æ–¹é¢æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œä½†å®ƒä¹Ÿéœ€è¦å¼€å‘äººå‘˜æ›´å¤šåœ°è‡ªæˆ‘å…‹åˆ¶æ¥ â€œæ­£ç¡®åœ°å®Œæˆå®ƒâ€ã€‚ä¹Ÿæœ‰äº›äººæ‹…å¿ƒ API ä¼šè®©æ²¡æœ‰ç»éªŒçš„äººç¼–å†™å‡ºé¢æ¡ä»£ç ã€‚æ¢å¥è¯è¯´ï¼Œè™½ç„¶ç»„åˆå¼ API æé«˜äº†ä»£ç è´¨é‡çš„ä¸Šé™ï¼Œä½†å®ƒä¹Ÿé™ä½äº†ä¸‹é™ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æ›´å¤šçš„è€ƒè™‘å¦‚ä½•åˆç†çš„ç»„ç»‡ä»£ç ï¼Œæ¨èæ ¹æ®é€»è¾‘å…³æ³¨ç‚¹å°†ç¨‹åºåˆ†è§£æˆå‡½æ•°å’Œæ¨¡å—æ¥ç»„ç»‡å®ƒã€‚</p>
<h2 id="setupscript">SetupScript</h2>
<p><code>&lt;script setup&gt;</code> æ˜¯åœ¨å•æ–‡ä»¶ç»„ä»¶ (SFC) ä¸­ä½¿ç”¨ç»„åˆå¼ API çš„ç¼–è¯‘æ—¶è¯­æ³•ç³–ã€‚ç›¸æ¯”äºæ™®é€šçš„ <code>&lt;script&gt;</code> è¯­æ³•ï¼Œå®ƒå…·æœ‰æ›´å¤šä¼˜åŠ¿ï¼š</p>
<ul>
<li>æ›´å°‘çš„æ ·æ¿å†…å®¹ï¼Œæ›´ç®€æ´çš„ä»£ç ã€‚</li>
<li>èƒ½å¤Ÿä½¿ç”¨çº¯ Typescript å£°æ˜ props å’Œå‘å‡ºäº‹ä»¶ã€‚</li>
<li>æ›´å¥½çš„è¿è¡Œæ—¶æ€§èƒ½ (å…¶æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆä¸å…¶åŒä¸€ä½œç”¨åŸŸçš„æ¸²æŸ“å‡½æ•°ï¼Œæ²¡æœ‰ä»»ä½•çš„ä¸­é—´ä»£ç†)ã€‚</li>
<li>æ›´å¥½çš„ IDE ç±»å‹æ¨æ–­æ€§èƒ½ (å‡å°‘è¯­è¨€æœåŠ¡å™¨ä»ä»£ç ä¸­æŠ½ç¦»ç±»å‹çš„å·¥ä½œ)ã€‚</li>
</ul>
<pre><code class="language-vue">&lt;script setup&gt;
// å¯¼å…¥
import { capitalize } from './helpers'
// ç»„ä»¶
import MyComponent from './MyComponent.vue'
// å˜é‡
const msg = 'Hello!'

// å‡½æ•°
function log() {
  console.log(msg)
}

&lt;/script&gt;

&lt;template&gt;
  &lt;div @click=&quot;log&quot;&gt;{{ msg }}&lt;/div&gt;
  &lt;div&gt;{{ capitalize('hello') }}&lt;/div&gt;
  &lt;MyComponent /&gt;
&lt;/template&gt;
</code></pre>
<p>ä¸Šé¢<code>&lt;script setup&gt;</code>ä¸­çš„ä»£ç ä¼šè¢«ç¼–è¯‘æˆç»„ä»¶<code>setup()</code>å‡½æ•°çš„å†…å®¹ï¼Œä¸åŒçš„æ˜¯<code>&lt;script setup&gt;</code> ä¸­çš„ä»£ç ä¼šåœ¨æ¯æ¬¡ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºçš„æ—¶å€™æ‰§è¡Œã€‚è€Œä¸”æ‰€æœ‰<strong>é¡¶å±‚</strong>çš„ç»‘å®š (åŒ…æ‹¬å˜é‡ï¼Œå‡½æ•°å£°æ˜ï¼Œä»¥åŠ import å¼•å…¥çš„å†…å®¹) éƒ½ä¼šæš´éœ²ç»™æ¨¡æ¿ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œç”šè‡³è¿ç»„ä»¶éƒ½æ— éœ€æ‰‹åŠ¨æ³¨å†Œã€‚</p>
<p>åœ¨ç»§ç»­ä¸‹é¢çš„å†…å®¹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè¯<strong>ç¼–è¯‘å™¨å®</strong>ï¼Œä»–ä»¬ä¸éœ€è¦å¯¼å…¥ï¼Œä¸”ä¼šåœ¨å¤„ç† <code>&lt;script setup&gt;</code> çš„æ—¶å€™è¢«ç¼–è¯‘å¤„ç†æ‰ã€‚<code>&lt;script setup&gt;</code>æä¾›äº†å¦‚ä¸‹å‡ ä¸ªç¼–è¯‘å™¨å®ï¼š</p>
<pre><code class="language-markdown">- defineProps
- defineEmits
- defineExpose
- withDefaults
</code></pre>
<p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹<code>&lt;script setup&gt;</code>ç‹¬æœ‰çš„APIï¼š</p>
<ul>
<li><code>defineProps</code>å£°æ˜Propsï¼Œæ¥æ”¶<code>props</code>é€‰é¡¹ç›¸åŒçš„å€¼</li>
</ul>
<pre><code class="language-js">const props = defineProps({
  foo: {
    type:String,
    default:''
  }
})
</code></pre>
<p>å¦‚æœä½¿ç”¨äº†TypeScriptï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨çº¯ç±»å‹å£°æ˜æ¥å£°æ˜Propsã€‚</p>
<pre><code class="language-ts">// æ™®é€š
const props = defineProps&lt;{
  foo: string
  bar?: number
}&gt;()


// é»˜è®¤å€¼
interface Props {
  msg?: string
  labels?: string[]
}

const props = withDefaults(defineProps&lt;Props&gt;(), {
  msg: 'hello',
  labels: () =&gt; ['one', 'two']
})
</code></pre>
<ul>
<li><code>defineEmits</code>å£°æ˜emitsï¼Œæ¥æ”¶ <code>emits</code> é€‰é¡¹ç›¸åŒçš„å€¼</li>
</ul>
<pre><code class="language-ts">// æ™®é€š
const emit = defineEmits(['change', 'delete'])
// TSç±»å‹å£°æ˜
const emit = defineEmits&lt;{
  (e: 'change', id: number): void
  (e: 'update', value: string): void
}&gt;()
</code></pre>
<ul>
<li><code>defineExpose</code>å£°æ˜æš´éœ²çš„ç»‘å®š</li>
</ul>
<p>ä½¿ç”¨ <code>&lt;script setup&gt;</code> çš„ç»„ä»¶æ˜¯<strong>é»˜è®¤å…³é—­</strong>çš„ï¼Œä¹Ÿå³é€šè¿‡æ¨¡æ¿ ref æˆ–è€… <code>$parent</code> é“¾è·å–åˆ°çš„ç»„ä»¶çš„å…¬å¼€å®ä¾‹ï¼Œä¸ä¼šæš´éœ²ä»»ä½•åœ¨ <code>&lt;script setup&gt;</code> ä¸­å£°æ˜çš„ç»‘å®šã€‚éœ€è¦å¼€å‘è€…æ˜ç¡®å£°æ˜æš´éœ²çš„å±æ€§ã€‚</p>
<pre><code class="language-js">&lt;script setup&gt;
import { ref } from 'vue'

const a = 1
const b = ref(2)

defineExpose({
  a,
  b
})
&lt;/script&gt;
</code></pre>
<ul>
<li><code>useSlots</code> å’Œ <code>useAttrs</code>åˆ†åˆ«å¯¹åº”<code>setupContext.slots</code> å’Œ <code>setupContext.attrs</code>ï¼Œä¹Ÿå¯ä»¥åœ¨æ™®é€šçš„ç»„åˆå¼ API ä¸­ä½¿ç”¨ã€‚</li>
</ul>
<pre><code class="language-vue">&lt;script setup&gt;
import { useSlots, useAttrs } from 'vue'

const slots = useSlots()
const attrs = useAttrs()
&lt;/script&gt;
</code></pre>
<p>ç›®å‰è¿˜æœ‰ä¸€äº›äº‹æƒ…æ˜¯ <code>&lt;script setup&gt;</code>ä¸èƒ½åšåˆ°çš„ï¼Œå°±éœ€è¦å’Œæ™®é€šçš„<code>&lt;script&gt;</code>ä¸€èµ·ä½¿ç”¨:</p>
<pre><code class="language-vue">&lt;script&gt;
// æ™®é€š &lt;script&gt;, åœ¨æ¨¡å—èŒƒå›´ä¸‹æ‰§è¡Œ(åªæ‰§è¡Œä¸€æ¬¡)
runSideEffectOnce()

// å£°æ˜é¢å¤–çš„é€‰é¡¹
export default {
  inheritAttrs: false,
  customOptions: {}
}
&lt;/script&gt;

&lt;script setup&gt;
// åœ¨ setup() ä½œç”¨åŸŸä¸­æ‰§è¡Œ (å¯¹æ¯ä¸ªå®ä¾‹çš†å¦‚æ­¤)
&lt;/script&gt;
</code></pre>
<p>æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹<a href="https://v3.cn.vuejs.org/api/sfc-script-setup.html">SetupScript</a>ã€‚</p>
<h1 id="å…¶ä»–-2">å…¶ä»–</h1>
<ul>
<li>
<p><a href="https://v3.cn.vuejs.org/api/sfc-style.html">Styleæ–°ç‰¹æ€§</a></p>
<ul>
<li>é€‰æ‹©å™¨</li>
</ul>
<pre><code class="language-css">/* æ·±åº¦é€‰æ‹©å™¨ */
.a :deep(.b) {
  /* ... */
}

/* æ’æ§½é€‰æ‹©å™¨ */
:slotted(div) {
  color: red;
}

/* å…¨å±€é€‰æ‹©å™¨ */
:global(.red) {
  color: red;
}
</code></pre>
<ul>
<li><code>&lt;style module&gt;</code></li>
</ul>
</li>
</ul>
<pre><code class="language-vue">&lt;template&gt;
  &lt;p :class=&quot;$style.red&quot;&gt;
    This should be red
  &lt;/p&gt;
&lt;/template&gt;

&lt;style module&gt;
.red {
  color: red;
}
&lt;/style&gt;
</code></pre>
<p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ³¨å…¥çš„åç§°ï¼š</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;p :class=&quot;classes.red&quot;&gt;red&lt;/p&gt;
&lt;/template&gt;

&lt;style module=&quot;classes&quot;&gt;
.red {
  color: red;
}
&lt;/style&gt;
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ç»„åˆAPIä¸­é€šè¿‡<a href="https://v3.cn.vuejs.org/api/global-api.html#usecssmodule"><code>useCssModule</code></a>æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-js">// é»˜è®¤, è¿”å› &lt;style module&gt; ä¸­çš„ç±»
useCssModule()

// å‘½å, è¿”å› &lt;style module=&quot;classes&quot;&gt; ä¸­çš„ç±»
useCssModule('classes')
</code></pre>
<p>ä½¿ç”¨çŠ¶æ€é©±åŠ¨çš„åŠ¨æ€ CSSï¼š</p>
<pre><code class="language-vue">&lt;script setup&gt;
const theme = {
  color: 'red'
}
&lt;/script&gt;

&lt;template&gt;
  &lt;p&gt;hello&lt;/p&gt;
&lt;/template&gt;

&lt;style scoped&gt;
p {
  color: v-bind('theme.color');
}
&lt;/style&gt;
</code></pre>
<ul>
<li>å…³æ³¨<a href="https://github.com/vuejs/rfcs">RFCS</a>ï¼Œå›æº¯å†å²ï¼Œæ´æ‚‰æœªæ¥</li>
</ul>

							</div>
	<div class="wow fadeInUp vt-post-tags">
 
				<a href="https://www.bwrong.cn/tag/1n1RvVqS8/" rel="tag">vue3</a>
				 
				<a href="https://www.bwrong.cn/tag/vue/" rel="tag">vue</a>
				 
					</div>
<nav class="navigation3 post-navigation3" role="navigation">

		<div class="nav-links3">
      
		<div class="wow fadeInUp nav-previous3"><a href="https://www.bwrong.cn/post/vue3-2/" rel="prev"> ã€Vue3ã€‘å®ç”¨æŒ‡å—</a></div>
		 
		 
		<div class="wow fadeInUp nav-next3"><a href="https://www.bwrong.cn/post/dev-tools07/" rel="next"> ã€å‰ç«¯å·¥ç¨‹åŒ–ã€‘ç¯‡ä¸ƒ æ²§æµ·é—ç -å…¶ä»–å·¥å…·</a></div>
		
		</div>
	</nav>
	<div class="wow fadeInUp author-info">
	<div class="author-avatar pull-left"><img src="https://www.bwrong.cn/images/avatar.png" ></div>
 
	<div class="author-description"><div class="author-title"><div class="author-link" rel="author">BWrong</div></div>


	<p class="author-bio">æ„¿ä½ èµ°å‡ºåŠç”Ÿï¼Œå½’æ¥ä»æ˜¯å°‘å¹´</p></div></div>
	
		</div>



</article>

<div id="marlin_lite_about_widget-2" class="wow fadeInUp widget marlin_lite_about_widget" data-wow-delay="0.1s">

        
		<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://www.bwrong.cn/media/scripts/Valine.min.js'></script>

<div class="comment"></div>
<script>
        new Valine({
            av: AV,
            el: '.comment',
            lang: 'zh-cn',
            visitor: false, // é˜…è¯»é‡ç»Ÿè®¡
            
            admin_email:'wang11535041@qq.com',
            
            
            emoticon_url: '/media/alu',
             
      emoticon_list: ["å.png","å–·è¡€.png","ç‹‚æ±—.png","ä¸è¯´è¯.png","æ±—.png","åç­‰.png","çŒ®èŠ±.png","ä¸é«˜å…´.png","ä¸­åˆ€.png","å®³ç¾.png","çš±çœ‰.png","å°çœ¼ç›.png","ä¸­æŒ‡.png","å°´å°¬.png","ç…ä½ .png","æƒ³ä¸€æƒ³.png","ä¸­æª.png","å¾—æ„.png","è‚¿åŒ….png","æ‰‡è€³å…‰.png","äº²äº².png","æƒŠå–œ.png","è„¸çº¢.png","æ— æ‰€è°“.png","ä¾¿ä¾¿.png","æ„¤æ€’.png","èœ¡çƒ›.png","çŒ®é»„ç“œ.png","å†…ä¼¤.png","æŠ•é™.png","è§‚å¯Ÿ.png","çœ‹ä¸è§.png","å‡»æŒ.png","æŠ é¼».png","é‚ªæ¶.png","çœ‹çƒ­é—¹.png","å£æ°´.png","æŠ½çƒŸ.png","é”çœ‰.png","è£…å¤§æ¬¾.png","åèˆŒ.png","æ— å¥ˆ.png","é•¿è‰.png","èµä¸€ä¸ª.png","å‘²ç‰™.png","æ— è¯­.png","é˜´æš—.png","ä¸å‡ºæ‰€æ–™.png","å’½æ°”.png","æœŸå¾….png","é«˜å…´.png","åè¡€å€’åœ°.png","å“­æ³£.png","æ¬¢å‘¼.png","é»‘çº¿.png","å–œæè€Œæ³£.png","å–·æ°´.png","æ·±æ€.png","é¼“æŒ.png","æš—åœ°è§‚å¯Ÿ.png"],
     
      app_id: 'jaz3TfUjRowK9fOMAPb9yw6i-MdYXbMMI',
      
      
      app_key: 'pbltxx4rElIP1RStL3AwujSp',
         
          
      placeholder: 'æ¬¢è¿ä½ ç•™ä¸‹è¶³è¿¹'
       
        });
    </script>





		</div>

			</div>
			


<div class="tocc col l3 hide-on-med-and-down">

        <div class="toc-widget">

            <div class="toc-title"></div>

            <div id="toc-content">


			</div>
        </div>
    </div>


<script src="https://www.bwrong.cn/media/scripts/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '.entry-summary',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1,h2' //**
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('.entry-summary').children('h1, h2').each(function () {/**/
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget').parent();
        // let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script>






			</div>
		</div>


		 <footer id="colophon" class="site-footer">

	<div class="container">

		<div class="copyright"> <br>Theme: <a
				href="https://github.com/alterfang/gridea-theme-pan" target="_blank" title="Pan"><span>Pan</span></a>.
			Powered by <a href="https://gridea.dev/" target="_blank" title="Gridea"><span>Gridea</span></a> . ç‰ˆæƒæ‰€æœ‰ï¼š<a href="https://beian.miit.gov.cn/" target="_blank"><span>èœ€ICPå¤‡2023018303å·-1</span></a></div>
	</div>

</footer>
		<!-- loding -->
		<div class="loader">
			<div class="loader-content">
				<div class="songjingge">
					<span></span>
					<span></span>
					<span></span>
					<span></span>
					<span></span>
				</div>
			</div>
		</div>
<script id="rendered-js">
	window.onload = function () {
			var loader = document.getElementsByClassName("loader")[0];
			loader.className = "loader fadeout"; //ä½¿ç”¨æ¸éšçš„æ–¹æ³•æ·¡å‡ºloading page
			setTimeout(function () {
				loader.style.display = "none";
			}, 0);
	};
</script>


</div>

<script src="https://cdn.bootcss.com/fitvids/1.2.0/jquery.fitvids.min.js"></script>
<script type='text/javascript' src='https://www.bwrong.cn/media/scripts/marlin-scripts.js'></script>
<script src="https://www.bwrong.cn/media/scripts/lately.min.js"></script>
<script>jQuery(document).ready(function () { $.lately({ 'target': '.lately-a,.lately-b,.lately-c' }) });</script>
<style type="text/css">
  a.back_to_top {
    text-decoration: none;
    position: fixed;
    bottom: 40px;
    right: 30px;
    background: #f0f0f0;
    height: 40px;
    width: 40px;
    border-radius: 50%;
    line-height: 36px;
    font-size: 18px;
    text-align: center;
    transition-duration: .5s;
    transition-propety: background-color;
    display: none;
  }

  a.back_to_top span {
    color: #888;
  }

  a.back_to_top:hover {
    cursor: pointer;
    background: #dfdfdf;
  }

  a.back_to_top:hover span {
    color: #555;
  }

  @media print,
  screen and (max-width: 580px) {
    .back_to_top {
      display: none !important;
    }
  }
</style><a id="back_to_top" href="#" class="back_to_top"><span><i class="iconfont icon-xiangshang"></i></span>
</a>

<script>
$(document).ready((function (_this) {
    return function () {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function () {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block');
          } else {
            return bt.css('display', 'none');
          }
        });
        return bt.click(function () {
          $('body,html').animate({
            scrollTop: 0
          }, 800);
          return false;
        });
      }
    };
  })(this));
//   $(window).load(function () {
//     //å¼‚æ­¥å»¶è¿ŸåŠ è½½æ ·å¼
//     var link = $('<link />');
//     link.attr('href', 'https://fonts.googleapis.com/css?family=Dancing+Script|Noto+Sans+SC:300|Montserrat&display=swap');
//     link.attr('rel', 'stylesheet');
//     link.appendTo($('head'));
// });
</script>

<!-- å® ç‰© -->
<canvas id="live2dcanvas" width="200" height="400" class="live2d"></canvas>
<style>
  #live2dcanvas {
    position: fixed;
    right: 0px;
    z-index: 999;
    pointer-events: none;
    bottom: -40px;
    width: 200px;
    height: 400px;
  }

  @media (max-width: 768px) {
    #live2dcanvas {
      width: 150px;
      height: 300px;
    }
  }

  @media (max-width: 639px) {
    #live2dcanvas {
      display: none !important;
    }
  }
</style>
<script src="https://www.bwrong.cn/media/scripts/L2Dwidget.min.js"></script>
<script>
  //åˆå§‹åŒ–å°äººç‰© éœ€è®¾ç½®å±æ€§pluginRootPath: "live2dw/"æŒ‡æ˜èµ„æºè·Ÿè·¯å¾„
  L2Dwidget.init({
    pluginRootPath: "media/",//èµ„æºrootè·¯å¾„
    pluginJsPath: "scripts/",//jsç›¸å¯¹rootçš„è·¯å¾„
    pluginModelPath: "model/",//æ¨¡å‹ç›¸å¯¹rootçš„è·¯å¾„
    tagMode: !1,
    debug: !1,
    model: {
      scale: 2,
      jsonPath: "/media/model/live2d-widget-model-epsilon/Epsilon2.1.model.json"
    },
    display: {//å¤§å°ä½ç½®ä»€ä¹ˆçš„è‡ªå·±æ…¢æ…¢è°ƒå°±æ˜¯äº†
      position: "right",//å®šä½
      width: 130,//å®½åº¦
      height: 210,//é«˜åº¦
      hOffset: -40,//å·¦å³
      vOffset: 0//ä¸Šä¸‹
    },
    mobile: {
      show: !1
    },
    log: !1
  });
</script>
<!-- å® ç‰©ç»“æŸ -->

		<script data-no-instant>
    // (function ($) {
    //     $.extend({
    //         adamsOverload: function () {
    //             $('.navigation:eq(0)').remove();
    //             $("").attr("rel" , "external");
    //             $("a[rel='external'],a[rel='external nofollow']").attr("target","_blank");
    //             $("a.vi").attr("rel" , "");
    //             $.viewImage({
    //                 'target'  : 'img',
    //                 'exclude' : '.vsmile-icons img,.gallery img',
    //                 'delay'   : 300
    //             });
    //             $.lately({
    //                 'target' : '.commentmetadata a,.infos time,.post-list time'
	// 			});
	// 			console.log(prettyPrint)
	// 			if(prettyPrint) prettyPrint();

    //             $('ul.links li a').each(function(){
    //                 if($(this).parent().find('.bg').length==0){
    //                     $(this).parent().append('<!---<div class="bg" style="background-image:url(https://c3.glgoo.top/s2/favicons?domain='+$(this).attr("href")+')"></div>--->')
    //                 }
    //             });
    //         }
    //     });
    // })(jQuery);
	// jQuery.adamsOverload();

    (function ($) {
        $.extend({
            adamsOverload: function () {
                $.viewImage({
                    'target'  : '.song img',
                    'exclude' : '.vsmile-icons img',
                    'delay'   : 300
                });
            }
        });
    })(jQuery);
    jQuery.adamsOverload();
</script>

</body>
</html>
